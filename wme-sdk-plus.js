var initWmeSdkPlus=function(){"use strict";var Sr=Object.defineProperty,Mr=(n,t,o)=>t in n?Sr(n,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[t]=o,lt=(n,t,o)=>Mr(n,typeof t!="symbol"?t+"":t,o),xt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},$t={};/*! *****************************************************************************
  Copyright (C) Microsoft. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0

  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.

  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */var Dt;function Er(){if(Dt)return $t;Dt=1;var n;return function(t){(function(o){var s=typeof globalThis=="object"?globalThis:typeof xt=="object"?xt:typeof self=="object"?self:typeof this=="object"?this:j(),w=g(t);typeof s.Reflect<"u"&&(w=g(s.Reflect,w)),o(w,s),typeof s.Reflect>"u"&&(s.Reflect=t);function g($,I){return function(E,A){Object.defineProperty($,E,{configurable:!0,writable:!0,value:A}),I&&I(E,A)}}function T(){try{return Function("return this;")()}catch{}}function S(){try{return(0,eval)("(function() { return this; })()")}catch{}}function j(){return T()||S()}})(function(o,s){var w=Object.prototype.hasOwnProperty,g=typeof Symbol=="function",T=g&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",S=g&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",j=typeof Object.create=="function",$={__proto__:[]}instanceof Array,I=!j&&!$,E={create:j?function(){return q(Object.create(null))}:$?function(){return q({__proto__:null})}:function(){return q({})},has:I?function(e,r){return w.call(e,r)}:function(e,r){return r in e},get:I?function(e,r){return w.call(e,r)?e[r]:void 0}:function(e,r){return e[r]}},A=Object.getPrototypeOf(Function),x=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:Ie(),W=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Pe(),K=typeof WeakMap=="function"?WeakMap:Re(),P=g?Symbol.for("@reflect-metadata:registry"):void 0,V=Ee(),J=je(V);function we(e,r,i,a){if(d(i)){if(!ae(e))throw new TypeError;if(!se(r))throw new TypeError;return ge(e,r)}else{if(!ae(e))throw new TypeError;if(!b(r))throw new TypeError;if(!b(a)&&!d(a)&&!R(a))throw new TypeError;return R(a)&&(a=void 0),i=M(i),ve(e,r,i,a)}}o("decorate",we);function F(e,r){function i(a,h){if(!b(a))throw new TypeError;if(!d(h)&&!Se(h))throw new TypeError;te(e,r,a,h)}return i}o("metadata",F);function C(e,r,i,a){if(!b(i))throw new TypeError;return d(a)||(a=M(a)),te(e,r,i,a)}o("defineMetadata",C);function L(e,r,i){if(!b(r))throw new TypeError;return d(i)||(i=M(i)),Q(e,r,i)}o("hasMetadata",L);function G(e,r,i){if(!b(r))throw new TypeError;return d(i)||(i=M(i)),H(e,r,i)}o("hasOwnMetadata",G);function ye(e,r,i){if(!b(r))throw new TypeError;return d(i)||(i=M(i)),X(e,r,i)}o("getMetadata",ye);function Z(e,r,i){if(!b(r))throw new TypeError;return d(i)||(i=M(i)),ee(e,r,i)}o("getOwnMetadata",Z);function Y(e,r){if(!b(e))throw new TypeError;return d(r)||(r=M(r)),re(e,r)}o("getMetadataKeys",Y);function pe(e,r){if(!b(e))throw new TypeError;return d(r)||(r=M(r)),ne(e,r)}o("getOwnMetadataKeys",pe);function _e(e,r,i){if(!b(r))throw new TypeError;if(d(i)||(i=M(i)),!b(r))throw new TypeError;d(i)||(i=M(i));var a=D(r,i,!1);return d(a)?!1:a.OrdinaryDeleteMetadata(e,r,i)}o("deleteMetadata",_e);function ge(e,r){for(var i=e.length-1;i>=0;--i){var a=e[i],h=a(r);if(!d(h)&&!R(h)){if(!se(h))throw new TypeError;r=h}}return r}function ve(e,r,i,a){for(var h=e.length-1;h>=0;--h){var k=e[h],m=k(r,i,a);if(!d(m)&&!R(m)){if(!b(m))throw new TypeError;a=m}}return a}function Q(e,r,i){var a=H(e,r,i);if(a)return!0;var h=U(r);return R(h)?!1:Q(e,h,i)}function H(e,r,i){var a=D(r,i,!1);return d(a)?!1:oe(a.OrdinaryHasOwnMetadata(e,r,i))}function X(e,r,i){var a=H(e,r,i);if(a)return ee(e,r,i);var h=U(r);if(!R(h))return X(e,h,i)}function ee(e,r,i){var a=D(r,i,!1);if(!d(a))return a.OrdinaryGetOwnMetadata(e,r,i)}function te(e,r,i,a){var h=D(i,a,!0);h.OrdinaryDefineOwnMetadata(e,r,i,a)}function re(e,r){var i=ne(e,r),a=U(e);if(a===null)return i;var h=re(a,r);if(h.length<=0)return i;if(i.length<=0)return h;for(var k=new W,m=[],p=0,u=i;p<u.length;p++){var c=u[p],f=k.has(c);f||(k.add(c),m.push(c))}for(var l=0,y=h;l<y.length;l++){var c=y[l],f=k.has(c);f||(k.add(c),m.push(c))}return m}function ne(e,r){var i=D(e,r,!1);return i?i.OrdinaryOwnMetadataKeys(e,r):[]}function ie(e){if(e===null)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return e===null?1:6;default:return 6}}function d(e){return e===void 0}function R(e){return e===null}function be(e){return typeof e=="symbol"}function b(e){return typeof e=="object"?e!==null:typeof e=="function"}function me(e,r){switch(ie(e)){case 0:return e;case 1:return e;case 2:return e;case 3:return e;case 4:return e;case 5:return e}var i="string",a=ue(e,T);if(a!==void 0){var h=a.call(e,i);if(b(h))throw new TypeError;return h}return ke(e)}function ke(e,r){var i,a;{var h=e.toString;if(z(h)){var a=h.call(e);if(!b(a))return a}var i=e.valueOf;if(z(i)){var a=i.call(e);if(!b(a))return a}}throw new TypeError}function oe(e){return!!e}function Oe(e){return""+e}function M(e){var r=me(e);return be(r)?r:Oe(r)}function ae(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:Object.prototype.toString.call(e)==="[object Array]"}function z(e){return typeof e=="function"}function se(e){return typeof e=="function"}function Se(e){switch(ie(e)){case 3:return!0;case 4:return!0;default:return!1}}function N(e,r){return e===r||e!==e&&r!==r}function ue(e,r){var i=e[r];if(i!=null){if(!z(i))throw new TypeError;return i}}function ce(e){var r=ue(e,S);if(!z(r))throw new TypeError;var i=r.call(e);if(!b(i))throw new TypeError;return i}function fe(e){return e.value}function le(e){var r=e.next();return r.done?!1:r}function he(e){var r=e.return;r&&r.call(e)}function U(e){var r=Object.getPrototypeOf(e);if(typeof e!="function"||e===A||r!==A)return r;var i=e.prototype,a=i&&Object.getPrototypeOf(i);if(a==null||a===Object.prototype)return r;var h=a.constructor;return typeof h!="function"||h===e?r:h}function Me(){var e;!d(P)&&typeof s.Reflect<"u"&&!(P in s.Reflect)&&typeof s.Reflect.defineMetadata=="function"&&(e=Te(s.Reflect));var r,i,a,h=new K,k={registerProvider:m,getProvider:u,setProvider:f};return k;function m(l){if(!Object.isExtensible(k))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case e===l:break;case d(r):r=l;break;case r===l:break;case d(i):i=l;break;case i===l:break;default:a===void 0&&(a=new W),a.add(l);break}}function p(l,y){if(!d(r)){if(r.isProviderFor(l,y))return r;if(!d(i)){if(i.isProviderFor(l,y))return r;if(!d(a))for(var _=ce(a);;){var v=le(_);if(!v)return;var O=fe(v);if(O.isProviderFor(l,y))return he(_),O}}}if(!d(e)&&e.isProviderFor(l,y))return e}function u(l,y){var _=h.get(l),v;return d(_)||(v=_.get(y)),d(v)&&(v=p(l,y),d(v)||(d(_)&&(_=new x,h.set(l,_)),_.set(y,v))),v}function c(l){if(d(l))throw new TypeError;return r===l||i===l||!d(a)&&a.has(l)}function f(l,y,_){if(!c(_))throw new Error("Metadata provider not registered.");var v=u(l,y);if(v!==_){if(!d(v))return!1;var O=h.get(l);d(O)&&(O=new x,h.set(l,O)),O.set(y,_)}return!0}}function Ee(){var e;return!d(P)&&b(s.Reflect)&&Object.isExtensible(s.Reflect)&&(e=s.Reflect[P]),d(e)&&(e=Me()),!d(P)&&b(s.Reflect)&&Object.isExtensible(s.Reflect)&&Object.defineProperty(s.Reflect,P,{enumerable:!1,configurable:!1,writable:!1,value:e}),e}function je(e){var r=new K,i={isProviderFor:function(c,f){var l=r.get(c);return d(l)?!1:l.has(f)},OrdinaryDefineOwnMetadata:m,OrdinaryHasOwnMetadata:h,OrdinaryGetOwnMetadata:k,OrdinaryOwnMetadataKeys:p,OrdinaryDeleteMetadata:u};return V.registerProvider(i),i;function a(c,f,l){var y=r.get(c),_=!1;if(d(y)){if(!l)return;y=new x,r.set(c,y),_=!0}var v=y.get(f);if(d(v)){if(!l)return;if(v=new x,y.set(f,v),!e.setProvider(c,f,i))throw y.delete(f),_&&r.delete(c),new Error("Wrong provider for target.")}return v}function h(c,f,l){var y=a(f,l,!1);return d(y)?!1:oe(y.has(c))}function k(c,f,l){var y=a(f,l,!1);if(!d(y))return y.get(c)}function m(c,f,l,y){var _=a(l,y,!0);_.set(c,f)}function p(c,f){var l=[],y=a(c,f,!1);if(d(y))return l;for(var _=y.keys(),v=ce(_),O=0;;){var de=le(v);if(!de)return l.length=O,l;var Ae=fe(de);try{l[O]=Ae}catch(xe){try{he(v)}finally{throw xe}}O++}}function u(c,f,l){var y=a(f,l,!1);if(d(y)||!y.delete(c))return!1;if(y.size===0){var _=r.get(f);d(_)||(_.delete(l),_.size===0&&r.delete(_))}return!0}}function Te(e){var r=e.defineMetadata,i=e.hasOwnMetadata,a=e.getOwnMetadata,h=e.getOwnMetadataKeys,k=e.deleteMetadata,m=new K,p={isProviderFor:function(u,c){var f=m.get(u);return!d(f)&&f.has(c)?!0:h(u,c).length?(d(f)&&(f=new W,m.set(u,f)),f.add(c),!0):!1},OrdinaryDefineOwnMetadata:r,OrdinaryHasOwnMetadata:i,OrdinaryGetOwnMetadata:a,OrdinaryOwnMetadataKeys:h,OrdinaryDeleteMetadata:k};return p}function D(e,r,i){var a=V.getProvider(e,r);if(!d(a))return a;if(i){if(V.setProvider(e,r,J))return J;throw new Error("Illegal state.")}}function Ie(){var e={},r=[],i=function(){function p(u,c,f){this._index=0,this._keys=u,this._values=c,this._selector=f}return p.prototype["@@iterator"]=function(){return this},p.prototype[S]=function(){return this},p.prototype.next=function(){var u=this._index;if(u>=0&&u<this._keys.length){var c=this._selector(this._keys[u],this._values[u]);return u+1>=this._keys.length?(this._index=-1,this._keys=r,this._values=r):this._index++,{value:c,done:!1}}return{value:void 0,done:!0}},p.prototype.throw=function(u){throw this._index>=0&&(this._index=-1,this._keys=r,this._values=r),u},p.prototype.return=function(u){return this._index>=0&&(this._index=-1,this._keys=r,this._values=r),{value:u,done:!0}},p}(),a=function(){function p(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(p.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),p.prototype.has=function(u){return this._find(u,!1)>=0},p.prototype.get=function(u){var c=this._find(u,!1);return c>=0?this._values[c]:void 0},p.prototype.set=function(u,c){var f=this._find(u,!0);return this._values[f]=c,this},p.prototype.delete=function(u){var c=this._find(u,!1);if(c>=0){for(var f=this._keys.length,l=c+1;l<f;l++)this._keys[l-1]=this._keys[l],this._values[l-1]=this._values[l];return this._keys.length--,this._values.length--,N(u,this._cacheKey)&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},p.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},p.prototype.keys=function(){return new i(this._keys,this._values,h)},p.prototype.values=function(){return new i(this._keys,this._values,k)},p.prototype.entries=function(){return new i(this._keys,this._values,m)},p.prototype["@@iterator"]=function(){return this.entries()},p.prototype[S]=function(){return this.entries()},p.prototype._find=function(u,c){if(!N(this._cacheKey,u)){this._cacheIndex=-1;for(var f=0;f<this._keys.length;f++)if(N(this._keys[f],u)){this._cacheIndex=f;break}}return this._cacheIndex<0&&c&&(this._cacheIndex=this._keys.length,this._keys.push(u),this._values.push(void 0)),this._cacheIndex},p}();return a;function h(p,u){return p}function k(p,u){return u}function m(p,u){return[p,u]}}function Pe(){var e=function(){function r(){this._map=new x}return Object.defineProperty(r.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),r.prototype.has=function(i){return this._map.has(i)},r.prototype.add=function(i){return this._map.set(i,i),this},r.prototype.delete=function(i){return this._map.delete(i)},r.prototype.clear=function(){this._map.clear()},r.prototype.keys=function(){return this._map.keys()},r.prototype.values=function(){return this._map.keys()},r.prototype.entries=function(){return this._map.entries()},r.prototype["@@iterator"]=function(){return this.keys()},r.prototype[S]=function(){return this.keys()},r}();return e}function Re(){var e=16,r=E.create(),i=a();return function(){function u(){this._key=a()}return u.prototype.has=function(c){var f=h(c,!1);return f!==void 0?E.has(f,this._key):!1},u.prototype.get=function(c){var f=h(c,!1);return f!==void 0?E.get(f,this._key):void 0},u.prototype.set=function(c,f){var l=h(c,!0);return l[this._key]=f,this},u.prototype.delete=function(c){var f=h(c,!1);return f!==void 0?delete f[this._key]:!1},u.prototype.clear=function(){this._key=a()},u}();function a(){var u;do u="@@WeakMap@@"+p();while(E.has(r,u));return r[u]=!0,u}function h(u,c){if(!w.call(u,i)){if(!c)return;Object.defineProperty(u,i,{value:E.create()})}return u[i]}function k(u,c){for(var f=0;f<c;++f)u[f]=Math.random()*255|0;return u}function m(u){if(typeof Uint8Array=="function"){var c=new Uint8Array(u);return typeof crypto<"u"?crypto.getRandomValues(c):typeof msCrypto<"u"?msCrypto.getRandomValues(c):k(c,u),c}return k(new Array(u),u)}function p(){var u=m(e);u[6]=u[6]&79|64,u[8]=u[8]&191|128;for(var c="",f=0;f<e;++f){var l=u[f];(f===4||f===6||f===8)&&(c+="-"),l<16&&(c+="0"),c+=l.toString(16).toLowerCase()}return c}}function q(e){return e.__=void 0,delete e.__,e}})}(n||(n={})),$t}Er();const ht=Symbol("ARTIFACTS");let jr=class{constructor(t){lt(this,"_recognizableHooks",new Map),lt(this,"_hookDependencies",new Map),lt(this,"_installedHooks",new Map);for(const[o,{hook:s,deps:w}]of Object.entries(t))this._recognizableHooks.set(o,s),w&&this._hookDependencies.set(o,w||[])}isHookInstalled(t,o){const s=this._recognizableHooks.get(o);if(!s||!this._installedHooks.has(t))return!1;const w=this._installedHooks.get(t);return w?w.some(g=>g===s):!1}markHookAsInstalled(t,o){var s;const w=this._recognizableHooks.get(o);if(!w)throw new Error(`Hook ${o} not found`);this._installedHooks.has(t)||this._installedHooks.set(t,[]),(s=this._installedHooks.get(t))==null||s.push(w)}async installHook(t,o){const s=this._recognizableHooks.get(t);if(!s)throw new Error(`Hook ${t} not found`);if(this.isHookInstalled(o,t))return;const w=this._hookDependencies.get(t)||[];for(const T of w)await this.installHook(T,o);const g=Reflect.getMetadata(ht,o)||{};Reflect.hasMetadata(ht,o)||Reflect.defineMetadata(ht,g,o);for(const T of s){const S=await T.install({sdk:o,artifacts:g});!S||typeof S!="object"||Object.assign(g,S)}this.markHookAsInstalled(o,t)}async installAllHooks(t){for(const o of this._recognizableHooks.keys())await this.installHook(o,t)}};var Tr=Object.defineProperty,Ir=(n,t,o)=>t in n?Tr(n,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[t]=o,Ke=(n,t,o)=>Ir(n,typeof t!="symbol"?t+"":t,o),Pr=Object.defineProperty,Rr=(n,t,o)=>t in n?Pr(n,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[t]=o,tt=(n,t,o)=>Rr(n,typeof t!="symbol"?t+"":t,o),Ft=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Vt={};/*! *****************************************************************************
  Copyright (C) Microsoft. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0

  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.

  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */var Ct;function Ar(){if(Ct)return Vt;Ct=1;var n;return function(t){(function(o){var s=typeof globalThis=="object"?globalThis:typeof Ft=="object"?Ft:typeof self=="object"?self:typeof this=="object"?this:j(),w=g(t);typeof s.Reflect<"u"&&(w=g(s.Reflect,w)),o(w,s),typeof s.Reflect>"u"&&(s.Reflect=t);function g($,I){return function(E,A){Object.defineProperty($,E,{configurable:!0,writable:!0,value:A}),I&&I(E,A)}}function T(){try{return Function("return this;")()}catch{}}function S(){try{return(0,eval)("(function() { return this; })()")}catch{}}function j(){return T()||S()}})(function(o,s){var w=Object.prototype.hasOwnProperty,g=typeof Symbol=="function",T=g&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",S=g&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",j=typeof Object.create=="function",$={__proto__:[]}instanceof Array,I=!j&&!$,E={create:j?function(){return q(Object.create(null))}:$?function(){return q({__proto__:null})}:function(){return q({})},has:I?function(e,r){return w.call(e,r)}:function(e,r){return r in e},get:I?function(e,r){return w.call(e,r)?e[r]:void 0}:function(e,r){return e[r]}},A=Object.getPrototypeOf(Function),x=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:Ie(),W=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Pe(),K=typeof WeakMap=="function"?WeakMap:Re(),P=g?Symbol.for("@reflect-metadata:registry"):void 0,V=Ee(),J=je(V);function we(e,r,i,a){if(d(i)){if(!ae(e))throw new TypeError;if(!se(r))throw new TypeError;return ge(e,r)}else{if(!ae(e))throw new TypeError;if(!b(r))throw new TypeError;if(!b(a)&&!d(a)&&!R(a))throw new TypeError;return R(a)&&(a=void 0),i=M(i),ve(e,r,i,a)}}o("decorate",we);function F(e,r){function i(a,h){if(!b(a))throw new TypeError;if(!d(h)&&!Se(h))throw new TypeError;te(e,r,a,h)}return i}o("metadata",F);function C(e,r,i,a){if(!b(i))throw new TypeError;return d(a)||(a=M(a)),te(e,r,i,a)}o("defineMetadata",C);function L(e,r,i){if(!b(r))throw new TypeError;return d(i)||(i=M(i)),Q(e,r,i)}o("hasMetadata",L);function G(e,r,i){if(!b(r))throw new TypeError;return d(i)||(i=M(i)),H(e,r,i)}o("hasOwnMetadata",G);function ye(e,r,i){if(!b(r))throw new TypeError;return d(i)||(i=M(i)),X(e,r,i)}o("getMetadata",ye);function Z(e,r,i){if(!b(r))throw new TypeError;return d(i)||(i=M(i)),ee(e,r,i)}o("getOwnMetadata",Z);function Y(e,r){if(!b(e))throw new TypeError;return d(r)||(r=M(r)),re(e,r)}o("getMetadataKeys",Y);function pe(e,r){if(!b(e))throw new TypeError;return d(r)||(r=M(r)),ne(e,r)}o("getOwnMetadataKeys",pe);function _e(e,r,i){if(!b(r))throw new TypeError;if(d(i)||(i=M(i)),!b(r))throw new TypeError;d(i)||(i=M(i));var a=D(r,i,!1);return d(a)?!1:a.OrdinaryDeleteMetadata(e,r,i)}o("deleteMetadata",_e);function ge(e,r){for(var i=e.length-1;i>=0;--i){var a=e[i],h=a(r);if(!d(h)&&!R(h)){if(!se(h))throw new TypeError;r=h}}return r}function ve(e,r,i,a){for(var h=e.length-1;h>=0;--h){var k=e[h],m=k(r,i,a);if(!d(m)&&!R(m)){if(!b(m))throw new TypeError;a=m}}return a}function Q(e,r,i){var a=H(e,r,i);if(a)return!0;var h=U(r);return R(h)?!1:Q(e,h,i)}function H(e,r,i){var a=D(r,i,!1);return d(a)?!1:oe(a.OrdinaryHasOwnMetadata(e,r,i))}function X(e,r,i){var a=H(e,r,i);if(a)return ee(e,r,i);var h=U(r);if(!R(h))return X(e,h,i)}function ee(e,r,i){var a=D(r,i,!1);if(!d(a))return a.OrdinaryGetOwnMetadata(e,r,i)}function te(e,r,i,a){var h=D(i,a,!0);h.OrdinaryDefineOwnMetadata(e,r,i,a)}function re(e,r){var i=ne(e,r),a=U(e);if(a===null)return i;var h=re(a,r);if(h.length<=0)return i;if(i.length<=0)return h;for(var k=new W,m=[],p=0,u=i;p<u.length;p++){var c=u[p],f=k.has(c);f||(k.add(c),m.push(c))}for(var l=0,y=h;l<y.length;l++){var c=y[l],f=k.has(c);f||(k.add(c),m.push(c))}return m}function ne(e,r){var i=D(e,r,!1);return i?i.OrdinaryOwnMetadataKeys(e,r):[]}function ie(e){if(e===null)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return e===null?1:6;default:return 6}}function d(e){return e===void 0}function R(e){return e===null}function be(e){return typeof e=="symbol"}function b(e){return typeof e=="object"?e!==null:typeof e=="function"}function me(e,r){switch(ie(e)){case 0:return e;case 1:return e;case 2:return e;case 3:return e;case 4:return e;case 5:return e}var i="string",a=ue(e,T);if(a!==void 0){var h=a.call(e,i);if(b(h))throw new TypeError;return h}return ke(e)}function ke(e,r){var i,a;{var h=e.toString;if(z(h)){var a=h.call(e);if(!b(a))return a}var i=e.valueOf;if(z(i)){var a=i.call(e);if(!b(a))return a}}throw new TypeError}function oe(e){return!!e}function Oe(e){return""+e}function M(e){var r=me(e);return be(r)?r:Oe(r)}function ae(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:Object.prototype.toString.call(e)==="[object Array]"}function z(e){return typeof e=="function"}function se(e){return typeof e=="function"}function Se(e){switch(ie(e)){case 3:return!0;case 4:return!0;default:return!1}}function N(e,r){return e===r||e!==e&&r!==r}function ue(e,r){var i=e[r];if(i!=null){if(!z(i))throw new TypeError;return i}}function ce(e){var r=ue(e,S);if(!z(r))throw new TypeError;var i=r.call(e);if(!b(i))throw new TypeError;return i}function fe(e){return e.value}function le(e){var r=e.next();return r.done?!1:r}function he(e){var r=e.return;r&&r.call(e)}function U(e){var r=Object.getPrototypeOf(e);if(typeof e!="function"||e===A||r!==A)return r;var i=e.prototype,a=i&&Object.getPrototypeOf(i);if(a==null||a===Object.prototype)return r;var h=a.constructor;return typeof h!="function"||h===e?r:h}function Me(){var e;!d(P)&&typeof s.Reflect<"u"&&!(P in s.Reflect)&&typeof s.Reflect.defineMetadata=="function"&&(e=Te(s.Reflect));var r,i,a,h=new K,k={registerProvider:m,getProvider:u,setProvider:f};return k;function m(l){if(!Object.isExtensible(k))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case e===l:break;case d(r):r=l;break;case r===l:break;case d(i):i=l;break;case i===l:break;default:a===void 0&&(a=new W),a.add(l);break}}function p(l,y){if(!d(r)){if(r.isProviderFor(l,y))return r;if(!d(i)){if(i.isProviderFor(l,y))return r;if(!d(a))for(var _=ce(a);;){var v=le(_);if(!v)return;var O=fe(v);if(O.isProviderFor(l,y))return he(_),O}}}if(!d(e)&&e.isProviderFor(l,y))return e}function u(l,y){var _=h.get(l),v;return d(_)||(v=_.get(y)),d(v)&&(v=p(l,y),d(v)||(d(_)&&(_=new x,h.set(l,_)),_.set(y,v))),v}function c(l){if(d(l))throw new TypeError;return r===l||i===l||!d(a)&&a.has(l)}function f(l,y,_){if(!c(_))throw new Error("Metadata provider not registered.");var v=u(l,y);if(v!==_){if(!d(v))return!1;var O=h.get(l);d(O)&&(O=new x,h.set(l,O)),O.set(y,_)}return!0}}function Ee(){var e;return!d(P)&&b(s.Reflect)&&Object.isExtensible(s.Reflect)&&(e=s.Reflect[P]),d(e)&&(e=Me()),!d(P)&&b(s.Reflect)&&Object.isExtensible(s.Reflect)&&Object.defineProperty(s.Reflect,P,{enumerable:!1,configurable:!1,writable:!1,value:e}),e}function je(e){var r=new K,i={isProviderFor:function(c,f){var l=r.get(c);return d(l)?!1:l.has(f)},OrdinaryDefineOwnMetadata:m,OrdinaryHasOwnMetadata:h,OrdinaryGetOwnMetadata:k,OrdinaryOwnMetadataKeys:p,OrdinaryDeleteMetadata:u};return V.registerProvider(i),i;function a(c,f,l){var y=r.get(c),_=!1;if(d(y)){if(!l)return;y=new x,r.set(c,y),_=!0}var v=y.get(f);if(d(v)){if(!l)return;if(v=new x,y.set(f,v),!e.setProvider(c,f,i))throw y.delete(f),_&&r.delete(c),new Error("Wrong provider for target.")}return v}function h(c,f,l){var y=a(f,l,!1);return d(y)?!1:oe(y.has(c))}function k(c,f,l){var y=a(f,l,!1);if(!d(y))return y.get(c)}function m(c,f,l,y){var _=a(l,y,!0);_.set(c,f)}function p(c,f){var l=[],y=a(c,f,!1);if(d(y))return l;for(var _=y.keys(),v=ce(_),O=0;;){var de=le(v);if(!de)return l.length=O,l;var Ae=fe(de);try{l[O]=Ae}catch(xe){try{he(v)}finally{throw xe}}O++}}function u(c,f,l){var y=a(f,l,!1);if(d(y)||!y.delete(c))return!1;if(y.size===0){var _=r.get(f);d(_)||(_.delete(l),_.size===0&&r.delete(_))}return!0}}function Te(e){var r=e.defineMetadata,i=e.hasOwnMetadata,a=e.getOwnMetadata,h=e.getOwnMetadataKeys,k=e.deleteMetadata,m=new K,p={isProviderFor:function(u,c){var f=m.get(u);return!d(f)&&f.has(c)?!0:h(u,c).length?(d(f)&&(f=new W,m.set(u,f)),f.add(c),!0):!1},OrdinaryDefineOwnMetadata:r,OrdinaryHasOwnMetadata:i,OrdinaryGetOwnMetadata:a,OrdinaryOwnMetadataKeys:h,OrdinaryDeleteMetadata:k};return p}function D(e,r,i){var a=V.getProvider(e,r);if(!d(a))return a;if(i){if(V.setProvider(e,r,J))return J;throw new Error("Illegal state.")}}function Ie(){var e={},r=[],i=function(){function p(u,c,f){this._index=0,this._keys=u,this._values=c,this._selector=f}return p.prototype["@@iterator"]=function(){return this},p.prototype[S]=function(){return this},p.prototype.next=function(){var u=this._index;if(u>=0&&u<this._keys.length){var c=this._selector(this._keys[u],this._values[u]);return u+1>=this._keys.length?(this._index=-1,this._keys=r,this._values=r):this._index++,{value:c,done:!1}}return{value:void 0,done:!0}},p.prototype.throw=function(u){throw this._index>=0&&(this._index=-1,this._keys=r,this._values=r),u},p.prototype.return=function(u){return this._index>=0&&(this._index=-1,this._keys=r,this._values=r),{value:u,done:!0}},p}(),a=function(){function p(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(p.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),p.prototype.has=function(u){return this._find(u,!1)>=0},p.prototype.get=function(u){var c=this._find(u,!1);return c>=0?this._values[c]:void 0},p.prototype.set=function(u,c){var f=this._find(u,!0);return this._values[f]=c,this},p.prototype.delete=function(u){var c=this._find(u,!1);if(c>=0){for(var f=this._keys.length,l=c+1;l<f;l++)this._keys[l-1]=this._keys[l],this._values[l-1]=this._values[l];return this._keys.length--,this._values.length--,N(u,this._cacheKey)&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},p.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},p.prototype.keys=function(){return new i(this._keys,this._values,h)},p.prototype.values=function(){return new i(this._keys,this._values,k)},p.prototype.entries=function(){return new i(this._keys,this._values,m)},p.prototype["@@iterator"]=function(){return this.entries()},p.prototype[S]=function(){return this.entries()},p.prototype._find=function(u,c){if(!N(this._cacheKey,u)){this._cacheIndex=-1;for(var f=0;f<this._keys.length;f++)if(N(this._keys[f],u)){this._cacheIndex=f;break}}return this._cacheIndex<0&&c&&(this._cacheIndex=this._keys.length,this._keys.push(u),this._values.push(void 0)),this._cacheIndex},p}();return a;function h(p,u){return p}function k(p,u){return u}function m(p,u){return[p,u]}}function Pe(){var e=function(){function r(){this._map=new x}return Object.defineProperty(r.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),r.prototype.has=function(i){return this._map.has(i)},r.prototype.add=function(i){return this._map.set(i,i),this},r.prototype.delete=function(i){return this._map.delete(i)},r.prototype.clear=function(){this._map.clear()},r.prototype.keys=function(){return this._map.keys()},r.prototype.values=function(){return this._map.keys()},r.prototype.entries=function(){return this._map.entries()},r.prototype["@@iterator"]=function(){return this.keys()},r.prototype[S]=function(){return this.keys()},r}();return e}function Re(){var e=16,r=E.create(),i=a();return function(){function u(){this._key=a()}return u.prototype.has=function(c){var f=h(c,!1);return f!==void 0?E.has(f,this._key):!1},u.prototype.get=function(c){var f=h(c,!1);return f!==void 0?E.get(f,this._key):void 0},u.prototype.set=function(c,f){var l=h(c,!0);return l[this._key]=f,this},u.prototype.delete=function(c){var f=h(c,!1);return f!==void 0?delete f[this._key]:!1},u.prototype.clear=function(){this._key=a()},u}();function a(){var u;do u="@@WeakMap@@"+p();while(E.has(r,u));return r[u]=!0,u}function h(u,c){if(!w.call(u,i)){if(!c)return;Object.defineProperty(u,i,{value:E.create()})}return u[i]}function k(u,c){for(var f=0;f<c;++f)u[f]=Math.random()*255|0;return u}function m(u){if(typeof Uint8Array=="function"){var c=new Uint8Array(u);return typeof crypto<"u"?crypto.getRandomValues(c):typeof msCrypto<"u"?msCrypto.getRandomValues(c):k(c,u),c}return k(new Array(u),u)}function p(){var u=m(e);u[6]=u[6]&79|64,u[8]=u[8]&191|128;for(var c="",f=0;f<e;++f){var l=u[f];(f===4||f===6||f===8)&&(c+="-"),l<16&&(c+="0"),c+=l.toString(16).toLowerCase()}return c}}function q(e){return e.__=void 0,delete e.__,e}})}(n||(n={})),Vt}Ar();var xr=Object.defineProperty,$r=(n,t,o)=>t in n?xr(n,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[t]=o,We=(n,t,o)=>$r(n,typeof t!="symbol"?t+"":t,o);let Dr=class{constructor(t,o){We(this,"_target"),We(this,"_key"),We(this,"_oldValue"),We(this,"_wasDefined",!1),We(this,"_isSwapped",!1),this._target=t,this._key=o,this._oldValue=this._target[this._key]}get isSwapped(){return this._isSwapped}get originalValue(){return this._oldValue}get value(){return this._target[this._key]}get target(){return this._target}restore(){this.isSwapped&&(this._wasDefined?this._target[this._key]=this._oldValue:delete this._target[this._key],this._isSwapped=!1)}swap(t){this.isSwapped||(this._wasDefined=Object.hasOwn(this._target,this._key),this._oldValue=this._target[this._key]),this._target[this._key]=t,this._isSwapped=!0}};const Fr={onlyIfNotExists:!0,isFactory:!1};class rt{constructor(t,o,s={}){if(tt(this,"_installedInstances",new Map),tt(this,"_path"),tt(this,"_targetValue"),tt(this,"_options"),this._path=t.split("."),this._path.length===0)throw new Error("Path must not be empty");this._targetValue=o,this._options={...Fr,...s}}_getTargetObject(t){let o=t;for(const s of this._path.slice(0,this._path.length-1))o[s]||(o[s]={}),o=o[s];return o}_createSwapper(t){const o=this._getTargetObject(t);return new Dr(o,this._path.at(-1))}install({sdk:t,...o}){if(this._installedInstances.has(t))return;const s=this._createSwapper(t);if(!(s.value&&this._options.onlyIfNotExists)){if(this._options.isFactory&&typeof this._targetValue=="function"){const w=this._targetValue({sdk:t,...o});s.swap(w)}else s.swap(this._targetValue);this._installedInstances.set(t,s)}}uninstall({sdk:t}){const o=this._installedInstances.get(t);o&&(o.restore(),this._installedInstances.delete(t))}}function zt(){return"unsafeWindow"in window?window.unsafeWindow:window}var Vr=Object.defineProperty,Cr=(n,t,o)=>t in n?Vr(n,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[t]=o,$e=(n,t,o)=>Cr(n,typeof t!="symbol"?t+"":t,o);class zr{constructor(t,o){$e(this,"_target"),$e(this,"_key"),$e(this,"_oldValue"),$e(this,"_wasDefined",!1),$e(this,"_isSwapped",!1),this._target=t,this._key=o,this._oldValue=this._target[this._key]}get isSwapped(){return this._isSwapped}get originalValue(){return this._oldValue}get value(){return this._target[this._key]}get target(){return this._target}restore(){this.isSwapped&&(this._wasDefined?this._target[this._key]=this._oldValue:delete this._target[this._key],this._isSwapped=!1)}swap(t){this.isSwapped||(this._wasDefined=Object.hasOwn(this._target,this._key),this._oldValue=this._target[this._key]),this._target[this._key]=t,this._isSwapped=!0}}let dt=class{constructor(t,o,s){$e(this,"_enabled",!1),$e(this,"_fnSwapper"),$e(this,"_interceptionFunction"),$e(this,"_middlewares",[]),this._fnSwapper=new zr(t,o),this._interceptionFunction=s}get enabled(){return this._fnSwapper.isSwapped&&this._enabled}disable(){this._enabled=!1,this.enabled}restore(){this._fnSwapper.restore()}enable(){this._enabled=!0,this._fnSwapper.isSwapped||this.swapToInterceptor()}swapToInterceptor(){const t=this;this._fnSwapper.swap(function(...o){if(!t._enabled)return t.callOriginalInvocator(...o);const s=t.runMiddlewares(o);if(s){if("output"in s)return s.output;"input"in s&&(o=s.input)}return t._interceptionFunction.call(this,t.getOriginalInvocator(this),...o)})}getOriginalInvocator(t){return this._fnSwapper.originalValue.bind(t??this._fnSwapper.target)}callOriginalInvocator(...t){return this.getOriginalInvocator()(...t)}runMiddlewares(t){for(const o of this._middlewares){const s=o(...t);if(s){if("output"in s)return s;"input"in s&&(t=s.input)}}return{input:t}}registerMiddleware(t){this._middlewares.push(t)}};function Kr(n,t){try{return n()}catch{return t}}let Wr=class extends dt{constructor(t,o,s){super(t,o,s),$e(this,"_loggedInvocationRequests",[]),this.registerMiddleware((...w)=>this.logRequest(...w))}logRequest(...t){this._loggedInvocationRequests.push(t)}flushLoggedRequests(){const t=this.getLoggedRequests();return this._loggedInvocationRequests=[],t}getLoggedRequests(){return this._loggedInvocationRequests}executeOriginalLoggedRequests(){this.flushLoggedRequests().forEach(t=>Kr(()=>this.callOriginalInvocator(...t)))}};class Hr{constructor(){Ke(this,"_hasResult",!1),Ke(this,"result")}store(t){return this.result=t,this._hasResult=!0,t}clear(){this.result=void 0,this._hasResult=!1}getResult(){if(!this.hasResult)throw new Error("No result is stored");return this.result}get hasResult(){return this._hasResult}}function Nr(n){const t=new Hr;new dt(n,"doAction",(o,...s)=>t.hasResult?t.getResult():t.store(o(...s))).enable(),new dt(n,"undoAction",(o,...s)=>{const w=o(...s);return t.clear(),w}).enable()}let Ur=class{constructor(){Ke(this,"actions",[]),Ke(this,"undoableActions",[])}acceptAction(t,o){const s={action:t,dataModel:o};t.undoSupported()&&(Nr(t),t.doAction(o),this.undoableActions.push(s)),this.actions.push(s)}undoAll(){this.undoableActions.forEach(({action:t,dataModel:o})=>t.undoAction(o))}getActions(){return this.actions.map(({action:t})=>t)}};function qr(){try{return zt().require("Waze/Action/MultiAction")}catch{return null}}function Lr(n){const t=qr();if(!t)throw new Error("Unable to retrieve MultiAction");return new t(n)}let Gr=class{constructor(t){Ke(this,"_activeTransaction",null),Ke(this,"_actionManagerAddInterceptor"),this._actionManagerAddInterceptor=new Wr(t,"add",(o,s)=>{var w,g;return(g=(w=this._activeTransaction)==null?void 0:w.acceptAction)==null||g.call(w,s,t.dataModel),!0})}openTransaction(){this._activeTransaction=new Ur,this._actionManagerAddInterceptor.enable()}closeTransaction(){const t=this._activeTransaction;return this._activeTransaction=null,this._actionManagerAddInterceptor.flushLoggedRequests(),this._actionManagerAddInterceptor.disable(),t}get hasTransaction(){return this._activeTransaction!==null}beginTransaction(){this.openTransaction()}commitTransaction(t){if(!this.hasTransaction)throw new Error("No open transaction found");try{const o=this._activeTransaction.getActions(),s=Lr(o);t&&(s._description=t),this._actionManagerAddInterceptor.callOriginalInvocator(s)}catch{this._actionManagerAddInterceptor.executeOriginalLoggedRequests()}finally{this.closeTransaction()}}cancelTransaction(){var t;(t=this._activeTransaction)==null||t.undoAll(),this.closeTransaction()}},pt;function nt(){if(!pt){const n=zt();pt=new Gr(n.W.model.actionManager)}return pt}const Br=[new rt("Editing.beginTransaction",()=>nt().beginTransaction()),new rt("Editing.commitTransaction",n=>nt().commitTransaction(n)),new rt("Editing.cancelTransaction",()=>nt().cancelTransaction()),new rt("Editing.doActions",(n,t)=>{const o=nt();o.beginTransaction();try{n(),o.commitTransaction(t)}catch(s){throw o.cancelTransaction(),s}})];var Jr=Object.defineProperty,Zr=(n,t,o)=>t in n?Jr(n,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[t]=o,it=(n,t,o)=>Zr(n,typeof t!="symbol"?t+"":t,o),Kt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Wt={};/*! *****************************************************************************
  Copyright (C) Microsoft. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0

  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.

  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */var Ht;function Yr(){if(Ht)return Wt;Ht=1;var n;return function(t){(function(o){var s=typeof globalThis=="object"?globalThis:typeof Kt=="object"?Kt:typeof self=="object"?self:typeof this=="object"?this:j(),w=g(t);typeof s.Reflect<"u"&&(w=g(s.Reflect,w)),o(w,s),typeof s.Reflect>"u"&&(s.Reflect=t);function g($,I){return function(E,A){Object.defineProperty($,E,{configurable:!0,writable:!0,value:A}),I&&I(E,A)}}function T(){try{return Function("return this;")()}catch{}}function S(){try{return(0,eval)("(function() { return this; })()")}catch{}}function j(){return T()||S()}})(function(o,s){var w=Object.prototype.hasOwnProperty,g=typeof Symbol=="function",T=g&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",S=g&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",j=typeof Object.create=="function",$={__proto__:[]}instanceof Array,I=!j&&!$,E={create:j?function(){return q(Object.create(null))}:$?function(){return q({__proto__:null})}:function(){return q({})},has:I?function(e,r){return w.call(e,r)}:function(e,r){return r in e},get:I?function(e,r){return w.call(e,r)?e[r]:void 0}:function(e,r){return e[r]}},A=Object.getPrototypeOf(Function),x=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:Ie(),W=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Pe(),K=typeof WeakMap=="function"?WeakMap:Re(),P=g?Symbol.for("@reflect-metadata:registry"):void 0,V=Ee(),J=je(V);function we(e,r,i,a){if(d(i)){if(!ae(e))throw new TypeError;if(!se(r))throw new TypeError;return ge(e,r)}else{if(!ae(e))throw new TypeError;if(!b(r))throw new TypeError;if(!b(a)&&!d(a)&&!R(a))throw new TypeError;return R(a)&&(a=void 0),i=M(i),ve(e,r,i,a)}}o("decorate",we);function F(e,r){function i(a,h){if(!b(a))throw new TypeError;if(!d(h)&&!Se(h))throw new TypeError;te(e,r,a,h)}return i}o("metadata",F);function C(e,r,i,a){if(!b(i))throw new TypeError;return d(a)||(a=M(a)),te(e,r,i,a)}o("defineMetadata",C);function L(e,r,i){if(!b(r))throw new TypeError;return d(i)||(i=M(i)),Q(e,r,i)}o("hasMetadata",L);function G(e,r,i){if(!b(r))throw new TypeError;return d(i)||(i=M(i)),H(e,r,i)}o("hasOwnMetadata",G);function ye(e,r,i){if(!b(r))throw new TypeError;return d(i)||(i=M(i)),X(e,r,i)}o("getMetadata",ye);function Z(e,r,i){if(!b(r))throw new TypeError;return d(i)||(i=M(i)),ee(e,r,i)}o("getOwnMetadata",Z);function Y(e,r){if(!b(e))throw new TypeError;return d(r)||(r=M(r)),re(e,r)}o("getMetadataKeys",Y);function pe(e,r){if(!b(e))throw new TypeError;return d(r)||(r=M(r)),ne(e,r)}o("getOwnMetadataKeys",pe);function _e(e,r,i){if(!b(r))throw new TypeError;if(d(i)||(i=M(i)),!b(r))throw new TypeError;d(i)||(i=M(i));var a=D(r,i,!1);return d(a)?!1:a.OrdinaryDeleteMetadata(e,r,i)}o("deleteMetadata",_e);function ge(e,r){for(var i=e.length-1;i>=0;--i){var a=e[i],h=a(r);if(!d(h)&&!R(h)){if(!se(h))throw new TypeError;r=h}}return r}function ve(e,r,i,a){for(var h=e.length-1;h>=0;--h){var k=e[h],m=k(r,i,a);if(!d(m)&&!R(m)){if(!b(m))throw new TypeError;a=m}}return a}function Q(e,r,i){var a=H(e,r,i);if(a)return!0;var h=U(r);return R(h)?!1:Q(e,h,i)}function H(e,r,i){var a=D(r,i,!1);return d(a)?!1:oe(a.OrdinaryHasOwnMetadata(e,r,i))}function X(e,r,i){var a=H(e,r,i);if(a)return ee(e,r,i);var h=U(r);if(!R(h))return X(e,h,i)}function ee(e,r,i){var a=D(r,i,!1);if(!d(a))return a.OrdinaryGetOwnMetadata(e,r,i)}function te(e,r,i,a){var h=D(i,a,!0);h.OrdinaryDefineOwnMetadata(e,r,i,a)}function re(e,r){var i=ne(e,r),a=U(e);if(a===null)return i;var h=re(a,r);if(h.length<=0)return i;if(i.length<=0)return h;for(var k=new W,m=[],p=0,u=i;p<u.length;p++){var c=u[p],f=k.has(c);f||(k.add(c),m.push(c))}for(var l=0,y=h;l<y.length;l++){var c=y[l],f=k.has(c);f||(k.add(c),m.push(c))}return m}function ne(e,r){var i=D(e,r,!1);return i?i.OrdinaryOwnMetadataKeys(e,r):[]}function ie(e){if(e===null)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return e===null?1:6;default:return 6}}function d(e){return e===void 0}function R(e){return e===null}function be(e){return typeof e=="symbol"}function b(e){return typeof e=="object"?e!==null:typeof e=="function"}function me(e,r){switch(ie(e)){case 0:return e;case 1:return e;case 2:return e;case 3:return e;case 4:return e;case 5:return e}var i="string",a=ue(e,T);if(a!==void 0){var h=a.call(e,i);if(b(h))throw new TypeError;return h}return ke(e)}function ke(e,r){var i,a;{var h=e.toString;if(z(h)){var a=h.call(e);if(!b(a))return a}var i=e.valueOf;if(z(i)){var a=i.call(e);if(!b(a))return a}}throw new TypeError}function oe(e){return!!e}function Oe(e){return""+e}function M(e){var r=me(e);return be(r)?r:Oe(r)}function ae(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:Object.prototype.toString.call(e)==="[object Array]"}function z(e){return typeof e=="function"}function se(e){return typeof e=="function"}function Se(e){switch(ie(e)){case 3:return!0;case 4:return!0;default:return!1}}function N(e,r){return e===r||e!==e&&r!==r}function ue(e,r){var i=e[r];if(i!=null){if(!z(i))throw new TypeError;return i}}function ce(e){var r=ue(e,S);if(!z(r))throw new TypeError;var i=r.call(e);if(!b(i))throw new TypeError;return i}function fe(e){return e.value}function le(e){var r=e.next();return r.done?!1:r}function he(e){var r=e.return;r&&r.call(e)}function U(e){var r=Object.getPrototypeOf(e);if(typeof e!="function"||e===A||r!==A)return r;var i=e.prototype,a=i&&Object.getPrototypeOf(i);if(a==null||a===Object.prototype)return r;var h=a.constructor;return typeof h!="function"||h===e?r:h}function Me(){var e;!d(P)&&typeof s.Reflect<"u"&&!(P in s.Reflect)&&typeof s.Reflect.defineMetadata=="function"&&(e=Te(s.Reflect));var r,i,a,h=new K,k={registerProvider:m,getProvider:u,setProvider:f};return k;function m(l){if(!Object.isExtensible(k))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case e===l:break;case d(r):r=l;break;case r===l:break;case d(i):i=l;break;case i===l:break;default:a===void 0&&(a=new W),a.add(l);break}}function p(l,y){if(!d(r)){if(r.isProviderFor(l,y))return r;if(!d(i)){if(i.isProviderFor(l,y))return r;if(!d(a))for(var _=ce(a);;){var v=le(_);if(!v)return;var O=fe(v);if(O.isProviderFor(l,y))return he(_),O}}}if(!d(e)&&e.isProviderFor(l,y))return e}function u(l,y){var _=h.get(l),v;return d(_)||(v=_.get(y)),d(v)&&(v=p(l,y),d(v)||(d(_)&&(_=new x,h.set(l,_)),_.set(y,v))),v}function c(l){if(d(l))throw new TypeError;return r===l||i===l||!d(a)&&a.has(l)}function f(l,y,_){if(!c(_))throw new Error("Metadata provider not registered.");var v=u(l,y);if(v!==_){if(!d(v))return!1;var O=h.get(l);d(O)&&(O=new x,h.set(l,O)),O.set(y,_)}return!0}}function Ee(){var e;return!d(P)&&b(s.Reflect)&&Object.isExtensible(s.Reflect)&&(e=s.Reflect[P]),d(e)&&(e=Me()),!d(P)&&b(s.Reflect)&&Object.isExtensible(s.Reflect)&&Object.defineProperty(s.Reflect,P,{enumerable:!1,configurable:!1,writable:!1,value:e}),e}function je(e){var r=new K,i={isProviderFor:function(c,f){var l=r.get(c);return d(l)?!1:l.has(f)},OrdinaryDefineOwnMetadata:m,OrdinaryHasOwnMetadata:h,OrdinaryGetOwnMetadata:k,OrdinaryOwnMetadataKeys:p,OrdinaryDeleteMetadata:u};return V.registerProvider(i),i;function a(c,f,l){var y=r.get(c),_=!1;if(d(y)){if(!l)return;y=new x,r.set(c,y),_=!0}var v=y.get(f);if(d(v)){if(!l)return;if(v=new x,y.set(f,v),!e.setProvider(c,f,i))throw y.delete(f),_&&r.delete(c),new Error("Wrong provider for target.")}return v}function h(c,f,l){var y=a(f,l,!1);return d(y)?!1:oe(y.has(c))}function k(c,f,l){var y=a(f,l,!1);if(!d(y))return y.get(c)}function m(c,f,l,y){var _=a(l,y,!0);_.set(c,f)}function p(c,f){var l=[],y=a(c,f,!1);if(d(y))return l;for(var _=y.keys(),v=ce(_),O=0;;){var de=le(v);if(!de)return l.length=O,l;var Ae=fe(de);try{l[O]=Ae}catch(xe){try{he(v)}finally{throw xe}}O++}}function u(c,f,l){var y=a(f,l,!1);if(d(y)||!y.delete(c))return!1;if(y.size===0){var _=r.get(f);d(_)||(_.delete(l),_.size===0&&r.delete(_))}return!0}}function Te(e){var r=e.defineMetadata,i=e.hasOwnMetadata,a=e.getOwnMetadata,h=e.getOwnMetadataKeys,k=e.deleteMetadata,m=new K,p={isProviderFor:function(u,c){var f=m.get(u);return!d(f)&&f.has(c)?!0:h(u,c).length?(d(f)&&(f=new W,m.set(u,f)),f.add(c),!0):!1},OrdinaryDefineOwnMetadata:r,OrdinaryHasOwnMetadata:i,OrdinaryGetOwnMetadata:a,OrdinaryOwnMetadataKeys:h,OrdinaryDeleteMetadata:k};return p}function D(e,r,i){var a=V.getProvider(e,r);if(!d(a))return a;if(i){if(V.setProvider(e,r,J))return J;throw new Error("Illegal state.")}}function Ie(){var e={},r=[],i=function(){function p(u,c,f){this._index=0,this._keys=u,this._values=c,this._selector=f}return p.prototype["@@iterator"]=function(){return this},p.prototype[S]=function(){return this},p.prototype.next=function(){var u=this._index;if(u>=0&&u<this._keys.length){var c=this._selector(this._keys[u],this._values[u]);return u+1>=this._keys.length?(this._index=-1,this._keys=r,this._values=r):this._index++,{value:c,done:!1}}return{value:void 0,done:!0}},p.prototype.throw=function(u){throw this._index>=0&&(this._index=-1,this._keys=r,this._values=r),u},p.prototype.return=function(u){return this._index>=0&&(this._index=-1,this._keys=r,this._values=r),{value:u,done:!0}},p}(),a=function(){function p(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(p.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),p.prototype.has=function(u){return this._find(u,!1)>=0},p.prototype.get=function(u){var c=this._find(u,!1);return c>=0?this._values[c]:void 0},p.prototype.set=function(u,c){var f=this._find(u,!0);return this._values[f]=c,this},p.prototype.delete=function(u){var c=this._find(u,!1);if(c>=0){for(var f=this._keys.length,l=c+1;l<f;l++)this._keys[l-1]=this._keys[l],this._values[l-1]=this._values[l];return this._keys.length--,this._values.length--,N(u,this._cacheKey)&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},p.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},p.prototype.keys=function(){return new i(this._keys,this._values,h)},p.prototype.values=function(){return new i(this._keys,this._values,k)},p.prototype.entries=function(){return new i(this._keys,this._values,m)},p.prototype["@@iterator"]=function(){return this.entries()},p.prototype[S]=function(){return this.entries()},p.prototype._find=function(u,c){if(!N(this._cacheKey,u)){this._cacheIndex=-1;for(var f=0;f<this._keys.length;f++)if(N(this._keys[f],u)){this._cacheIndex=f;break}}return this._cacheIndex<0&&c&&(this._cacheIndex=this._keys.length,this._keys.push(u),this._values.push(void 0)),this._cacheIndex},p}();return a;function h(p,u){return p}function k(p,u){return u}function m(p,u){return[p,u]}}function Pe(){var e=function(){function r(){this._map=new x}return Object.defineProperty(r.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),r.prototype.has=function(i){return this._map.has(i)},r.prototype.add=function(i){return this._map.set(i,i),this},r.prototype.delete=function(i){return this._map.delete(i)},r.prototype.clear=function(){this._map.clear()},r.prototype.keys=function(){return this._map.keys()},r.prototype.values=function(){return this._map.keys()},r.prototype.entries=function(){return this._map.entries()},r.prototype["@@iterator"]=function(){return this.keys()},r.prototype[S]=function(){return this.keys()},r}();return e}function Re(){var e=16,r=E.create(),i=a();return function(){function u(){this._key=a()}return u.prototype.has=function(c){var f=h(c,!1);return f!==void 0?E.has(f,this._key):!1},u.prototype.get=function(c){var f=h(c,!1);return f!==void 0?E.get(f,this._key):void 0},u.prototype.set=function(c,f){var l=h(c,!0);return l[this._key]=f,this},u.prototype.delete=function(c){var f=h(c,!1);return f!==void 0?delete f[this._key]:!1},u.prototype.clear=function(){this._key=a()},u}();function a(){var u;do u="@@WeakMap@@"+p();while(E.has(r,u));return r[u]=!0,u}function h(u,c){if(!w.call(u,i)){if(!c)return;Object.defineProperty(u,i,{value:E.create()})}return u[i]}function k(u,c){for(var f=0;f<c;++f)u[f]=Math.random()*255|0;return u}function m(u){if(typeof Uint8Array=="function"){var c=new Uint8Array(u);return typeof crypto<"u"?crypto.getRandomValues(c):typeof msCrypto<"u"?msCrypto.getRandomValues(c):k(c,u),c}return k(new Array(u),u)}function p(){var u=m(e);u[6]=u[6]&79|64,u[8]=u[8]&191|128;for(var c="",f=0;f<e;++f){var l=u[f];(f===4||f===6||f===8)&&(c+="-"),l<16&&(c+="0"),c+=l.toString(16).toLowerCase()}return c}}function q(e){return e.__=void 0,delete e.__,e}})}(n||(n={})),Wt}Yr();var Qr=Object.defineProperty,Xr=(n,t,o)=>t in n?Qr(n,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[t]=o,He=(n,t,o)=>Xr(n,typeof t!="symbol"?t+"":t,o);let en=class{constructor(t,o){He(this,"_target"),He(this,"_key"),He(this,"_oldValue"),He(this,"_wasDefined",!1),He(this,"_isSwapped",!1),this._target=t,this._key=o,this._oldValue=this._target[this._key]}get isSwapped(){return this._isSwapped}get originalValue(){return this._oldValue}get value(){return this._target[this._key]}get target(){return this._target}restore(){this.isSwapped&&(this._wasDefined?this._target[this._key]=this._oldValue:delete this._target[this._key],this._isSwapped=!1)}swap(t){this.isSwapped||(this._wasDefined=Object.hasOwn(this._target,this._key),this._oldValue=this._target[this._key]),this._target[this._key]=t,this._isSwapped=!0}};const tn={onlyIfNotExists:!0,isFactory:!1};let Nt=class{constructor(t,o,s={}){if(it(this,"_installedInstances",new Map),it(this,"_path"),it(this,"_targetValue"),it(this,"_options"),this._path=t.split("."),this._path.length===0)throw new Error("Path must not be empty");this._targetValue=o,this._options={...tn,...s}}_getTargetObject(t){let o=t;for(const s of this._path.slice(0,this._path.length-1))o[s]||(o[s]={}),o=o[s];return o}_createSwapper(t){const o=this._getTargetObject(t);return new en(o,this._path.at(-1))}install({sdk:t,...o}){if(this._installedInstances.has(t))return;const s=this._createSwapper(t);if(!(s.value&&this._options.onlyIfNotExists)){if(this._options.isFactory&&typeof this._targetValue=="function"){const w=this._targetValue({sdk:t,...o});s.swap(w)}else s.swap(this._targetValue);this._installedInstances.set(t,s)}}uninstall({sdk:t}){const o=this._installedInstances.get(t);o&&(o.restore(),this._installedInstances.delete(t))}};var rn=Object.defineProperty,nn=(n,t,o)=>t in n?rn(n,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[t]=o,Ne=(n,t,o)=>nn(n,typeof t!="symbol"?t+"":t,o);let on=class{constructor(t,o){Ne(this,"_target"),Ne(this,"_key"),Ne(this,"_oldValue"),Ne(this,"_wasDefined",!1),Ne(this,"_isSwapped",!1),this._target=t,this._key=o,this._oldValue=this._target[this._key]}get isSwapped(){return this._isSwapped}get originalValue(){return this._oldValue}get value(){return this._target[this._key]}get target(){return this._target}restore(){this.isSwapped&&(this._wasDefined?this._target[this._key]=this._oldValue:delete this._target[this._key],this._isSwapped=!1)}swap(t){this.isSwapped||(this._wasDefined=Object.hasOwn(this._target,this._key),this._oldValue=this._target[this._key]),this._target[this._key]=t,this._isSwapped=!0}};function yt(){return"unsafeWindow"in window?window.unsafeWindow:window}var an=Object.defineProperty,sn=(n,t,o)=>t in n?an(n,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[t]=o,Ut=(n,t,o)=>sn(n,typeof t!="symbol"?t+"":t,o);function Ue(){return"unsafeWindow"in window?window.unsafeWindow:window}var un=Object.defineProperty,cn=(n,t,o)=>t in n?un(n,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[t]=o,De=(n,t,o)=>cn(n,typeof t!="symbol"?t+"":t,o);let fn=class{constructor(t,o){De(this,"_target"),De(this,"_key"),De(this,"_oldValue"),De(this,"_wasDefined",!1),De(this,"_isSwapped",!1),this._target=t,this._key=o,this._oldValue=this._target[this._key]}get isSwapped(){return this._isSwapped}get originalValue(){return this._oldValue}get value(){return this._target[this._key]}get target(){return this._target}restore(){this.isSwapped&&(this._wasDefined?this._target[this._key]=this._oldValue:delete this._target[this._key],this._isSwapped=!1)}swap(t){this.isSwapped||(this._wasDefined=Object.hasOwn(this._target,this._key),this._oldValue=this._target[this._key]),this._target[this._key]=t,this._isSwapped=!0}},ln=class{constructor(t,o,s){De(this,"_enabled",!1),De(this,"_fnSwapper"),De(this,"_interceptionFunction"),De(this,"_middlewares",[]),this._fnSwapper=new fn(t,o),this._interceptionFunction=s}get enabled(){return this._fnSwapper.isSwapped&&this._enabled}disable(){this._enabled=!1,this.enabled}restore(){this._fnSwapper.restore()}enable(){this._enabled=!0,this._fnSwapper.isSwapped||this.swapToInterceptor()}swapToInterceptor(){const t=this;this._fnSwapper.swap(function(...o){if(!t._enabled)return t.callOriginalInvocator(...o);const s=t.runMiddlewares(o);if(s){if("output"in s)return s.output;"input"in s&&(o=s.input)}return t._interceptionFunction.call(this,t.getOriginalInvocator(this),...o)})}getOriginalInvocator(t){return this._fnSwapper.originalValue.bind(t??this._fnSwapper.target)}callOriginalInvocator(...t){return this.getOriginalInvocator()(...t)}runMiddlewares(t){for(const o of this._middlewares){const s=o(...t);if(s){if("output"in s)return s;"input"in s&&(t=s.input)}}return{input:t}}registerMiddleware(t){this._middlewares.push(t)}},hn=class{constructor(t){Ut(this,"_fetchInterceptor"),Ut(this,"_interceptionFilters",new Set),this._fetchInterceptor=new ln(t,"fetch",(o,s,w)=>{for(const g of this._interceptionFilters)if(g.shouldIntercept(s,w))return this.shouldKeepFilter(g,s,w)||this.removeInterceptionFilter(g),g.intercept(s,w);return o(s,w)})}enable(){this._fetchInterceptor.enable()}disable(){this._fetchInterceptor.disable()}addInterceptionFilter(t){this.enable(),this._interceptionFilters.add(t)}removeInterceptionFilter(t){this._interceptionFilters.delete(t)}shouldKeepFilter(t,o,s){return typeof t.shouldKeep=="function"?t.shouldKeep(o,s):typeof t.shouldKeep=="boolean"?t.shouldKeep:!1}};function dn(n){return n=n instanceof URL?n:new URL(n,Ue().location.href),t=>typeof t=="string"?new URL(t,Ue().location.href).pathname===n.pathname:t instanceof URL?t.pathname===n.pathname:new URL(t.url,Ue().location.href).pathname===new URL(n,Ue().location.href).pathname}function pn(n,t,o){const s=new Response(t,o),w=new URL(n,location.toString());return Object.defineProperty(s,"url",{value:w}),s}function yn(n,t){const o=JSON.stringify(t),s=new Headers({"Content-Type":"application/json"});return pn(n,o,{headers:s})}const wn=new hn(Ue());function _n(n){return!("descartesHttpClient"in n)&&"createAbortController"in n&&typeof n.createAbortController=="function"}function gn(){const n=yt().W.controller.descartesClient,t=_n(n)?n:n.descartesHttpClient,o=new on(t,"createAbortController");o.swap(()=>(o.restore(),new AbortController))}function vn(n){const t=yt();return gn(),t.W.controller.descartesClient.getFeatures([0,0,0,0],{[n]:!0},{})}async function bn(n,t){const o=yt().W.Config.paths.features;wn.addInterceptionFilter({shouldIntercept:dn(o),intercept(){return Promise.resolve(yn(o,{[n]:{objects:[t]}}))}});const{[n]:s}=await vn(n),[w]=s.objects;return w.constructor}function mn(n,t,o={}){const s={type:"Feature"};return(o.id===0||o.id)&&(s.id=o.id),o.bbox&&(s.bbox=o.bbox),s.properties={},s.geometry=n,s}function kn(n,t,o={}){if(!n)throw new Error("coordinates is required");if(!Array.isArray(n))throw new Error("coordinates must be an Array");if(n.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!qt(n[0])||!qt(n[1]))throw new Error("coordinates must contain numbers");return mn({type:"Point",coordinates:n},t,o)}function qt(n){return!isNaN(n)&&n!==null&&!Array.isArray(n)}function qe(){return"unsafeWindow"in window?window.unsafeWindow:window}function On(n){const t=qe().require("Waze/Action/CreateObject");return new t(n)}function Sn(n){qe().W.model.actionManager.add(On(n))}function Mn(n){return n.toISOString().slice(0,16).replace("T"," ")}function En(n){return qe().W.model.mapComments.getObjectById(n)}function jn(n,t){const o=qe().require("Waze/Action/UpdateObject");return new o(n,t)}function Tn(n,t){qe().W.model.actionManager.add(jn(n,t))}let wt;function In(){if(!wt)throw new Error("MapComment not initialized. Make sure to await the enhancedSDK function before using it.")}const Pn=[{async install(){wt=await bn("mapComments",{geometry:kn([0,0]).geometry})}},new Nt("DataModel.MapComments.addMapComment",n=>{In();const t=new wt({geoJSONGeometry:n.geometry,subject:n.subject,body:n.body,lockRank:n.lockRank,endDate:n.endDate?Mn(n.endDate):null});return Sn(t),t.getID()}),new Nt("DataModel.MapComments.updateMapComment",({sdkInstance:n})=>t=>{const o=En(t.mapCommentId);if(!o)throw new n.Errors.DataModelNotFoundError("mapComment",t.mapCommentId);const s={};t.geometry&&(s.geoJSONGeometry=t.geometry),t.subject&&(s.subject=t.subject),t.body&&(s.body=t.body),t.lockRank&&(s.lockRank=t.lockRank),Tn(o,s)},{isFactory:!0})];var Rn=Object.defineProperty,An=(n,t,o)=>t in n?Rn(n,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[t]=o,ot=(n,t,o)=>An(n,typeof t!="symbol"?t+"":t,o),Lt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Gt={};/*! *****************************************************************************
  Copyright (C) Microsoft. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0

  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.

  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */var Bt;function xn(){if(Bt)return Gt;Bt=1;var n;return function(t){(function(o){var s=typeof globalThis=="object"?globalThis:typeof Lt=="object"?Lt:typeof self=="object"?self:typeof this=="object"?this:j(),w=g(t);typeof s.Reflect<"u"&&(w=g(s.Reflect,w)),o(w,s),typeof s.Reflect>"u"&&(s.Reflect=t);function g($,I){return function(E,A){Object.defineProperty($,E,{configurable:!0,writable:!0,value:A}),I&&I(E,A)}}function T(){try{return Function("return this;")()}catch{}}function S(){try{return(0,eval)("(function() { return this; })()")}catch{}}function j(){return T()||S()}})(function(o,s){var w=Object.prototype.hasOwnProperty,g=typeof Symbol=="function",T=g&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",S=g&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",j=typeof Object.create=="function",$={__proto__:[]}instanceof Array,I=!j&&!$,E={create:j?function(){return q(Object.create(null))}:$?function(){return q({__proto__:null})}:function(){return q({})},has:I?function(e,r){return w.call(e,r)}:function(e,r){return r in e},get:I?function(e,r){return w.call(e,r)?e[r]:void 0}:function(e,r){return e[r]}},A=Object.getPrototypeOf(Function),x=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:Ie(),W=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Pe(),K=typeof WeakMap=="function"?WeakMap:Re(),P=g?Symbol.for("@reflect-metadata:registry"):void 0,V=Ee(),J=je(V);function we(e,r,i,a){if(d(i)){if(!ae(e))throw new TypeError;if(!se(r))throw new TypeError;return ge(e,r)}else{if(!ae(e))throw new TypeError;if(!b(r))throw new TypeError;if(!b(a)&&!d(a)&&!R(a))throw new TypeError;return R(a)&&(a=void 0),i=M(i),ve(e,r,i,a)}}o("decorate",we);function F(e,r){function i(a,h){if(!b(a))throw new TypeError;if(!d(h)&&!Se(h))throw new TypeError;te(e,r,a,h)}return i}o("metadata",F);function C(e,r,i,a){if(!b(i))throw new TypeError;return d(a)||(a=M(a)),te(e,r,i,a)}o("defineMetadata",C);function L(e,r,i){if(!b(r))throw new TypeError;return d(i)||(i=M(i)),Q(e,r,i)}o("hasMetadata",L);function G(e,r,i){if(!b(r))throw new TypeError;return d(i)||(i=M(i)),H(e,r,i)}o("hasOwnMetadata",G);function ye(e,r,i){if(!b(r))throw new TypeError;return d(i)||(i=M(i)),X(e,r,i)}o("getMetadata",ye);function Z(e,r,i){if(!b(r))throw new TypeError;return d(i)||(i=M(i)),ee(e,r,i)}o("getOwnMetadata",Z);function Y(e,r){if(!b(e))throw new TypeError;return d(r)||(r=M(r)),re(e,r)}o("getMetadataKeys",Y);function pe(e,r){if(!b(e))throw new TypeError;return d(r)||(r=M(r)),ne(e,r)}o("getOwnMetadataKeys",pe);function _e(e,r,i){if(!b(r))throw new TypeError;if(d(i)||(i=M(i)),!b(r))throw new TypeError;d(i)||(i=M(i));var a=D(r,i,!1);return d(a)?!1:a.OrdinaryDeleteMetadata(e,r,i)}o("deleteMetadata",_e);function ge(e,r){for(var i=e.length-1;i>=0;--i){var a=e[i],h=a(r);if(!d(h)&&!R(h)){if(!se(h))throw new TypeError;r=h}}return r}function ve(e,r,i,a){for(var h=e.length-1;h>=0;--h){var k=e[h],m=k(r,i,a);if(!d(m)&&!R(m)){if(!b(m))throw new TypeError;a=m}}return a}function Q(e,r,i){var a=H(e,r,i);if(a)return!0;var h=U(r);return R(h)?!1:Q(e,h,i)}function H(e,r,i){var a=D(r,i,!1);return d(a)?!1:oe(a.OrdinaryHasOwnMetadata(e,r,i))}function X(e,r,i){var a=H(e,r,i);if(a)return ee(e,r,i);var h=U(r);if(!R(h))return X(e,h,i)}function ee(e,r,i){var a=D(r,i,!1);if(!d(a))return a.OrdinaryGetOwnMetadata(e,r,i)}function te(e,r,i,a){var h=D(i,a,!0);h.OrdinaryDefineOwnMetadata(e,r,i,a)}function re(e,r){var i=ne(e,r),a=U(e);if(a===null)return i;var h=re(a,r);if(h.length<=0)return i;if(i.length<=0)return h;for(var k=new W,m=[],p=0,u=i;p<u.length;p++){var c=u[p],f=k.has(c);f||(k.add(c),m.push(c))}for(var l=0,y=h;l<y.length;l++){var c=y[l],f=k.has(c);f||(k.add(c),m.push(c))}return m}function ne(e,r){var i=D(e,r,!1);return i?i.OrdinaryOwnMetadataKeys(e,r):[]}function ie(e){if(e===null)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return e===null?1:6;default:return 6}}function d(e){return e===void 0}function R(e){return e===null}function be(e){return typeof e=="symbol"}function b(e){return typeof e=="object"?e!==null:typeof e=="function"}function me(e,r){switch(ie(e)){case 0:return e;case 1:return e;case 2:return e;case 3:return e;case 4:return e;case 5:return e}var i="string",a=ue(e,T);if(a!==void 0){var h=a.call(e,i);if(b(h))throw new TypeError;return h}return ke(e)}function ke(e,r){var i,a;{var h=e.toString;if(z(h)){var a=h.call(e);if(!b(a))return a}var i=e.valueOf;if(z(i)){var a=i.call(e);if(!b(a))return a}}throw new TypeError}function oe(e){return!!e}function Oe(e){return""+e}function M(e){var r=me(e);return be(r)?r:Oe(r)}function ae(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:Object.prototype.toString.call(e)==="[object Array]"}function z(e){return typeof e=="function"}function se(e){return typeof e=="function"}function Se(e){switch(ie(e)){case 3:return!0;case 4:return!0;default:return!1}}function N(e,r){return e===r||e!==e&&r!==r}function ue(e,r){var i=e[r];if(i!=null){if(!z(i))throw new TypeError;return i}}function ce(e){var r=ue(e,S);if(!z(r))throw new TypeError;var i=r.call(e);if(!b(i))throw new TypeError;return i}function fe(e){return e.value}function le(e){var r=e.next();return r.done?!1:r}function he(e){var r=e.return;r&&r.call(e)}function U(e){var r=Object.getPrototypeOf(e);if(typeof e!="function"||e===A||r!==A)return r;var i=e.prototype,a=i&&Object.getPrototypeOf(i);if(a==null||a===Object.prototype)return r;var h=a.constructor;return typeof h!="function"||h===e?r:h}function Me(){var e;!d(P)&&typeof s.Reflect<"u"&&!(P in s.Reflect)&&typeof s.Reflect.defineMetadata=="function"&&(e=Te(s.Reflect));var r,i,a,h=new K,k={registerProvider:m,getProvider:u,setProvider:f};return k;function m(l){if(!Object.isExtensible(k))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case e===l:break;case d(r):r=l;break;case r===l:break;case d(i):i=l;break;case i===l:break;default:a===void 0&&(a=new W),a.add(l);break}}function p(l,y){if(!d(r)){if(r.isProviderFor(l,y))return r;if(!d(i)){if(i.isProviderFor(l,y))return r;if(!d(a))for(var _=ce(a);;){var v=le(_);if(!v)return;var O=fe(v);if(O.isProviderFor(l,y))return he(_),O}}}if(!d(e)&&e.isProviderFor(l,y))return e}function u(l,y){var _=h.get(l),v;return d(_)||(v=_.get(y)),d(v)&&(v=p(l,y),d(v)||(d(_)&&(_=new x,h.set(l,_)),_.set(y,v))),v}function c(l){if(d(l))throw new TypeError;return r===l||i===l||!d(a)&&a.has(l)}function f(l,y,_){if(!c(_))throw new Error("Metadata provider not registered.");var v=u(l,y);if(v!==_){if(!d(v))return!1;var O=h.get(l);d(O)&&(O=new x,h.set(l,O)),O.set(y,_)}return!0}}function Ee(){var e;return!d(P)&&b(s.Reflect)&&Object.isExtensible(s.Reflect)&&(e=s.Reflect[P]),d(e)&&(e=Me()),!d(P)&&b(s.Reflect)&&Object.isExtensible(s.Reflect)&&Object.defineProperty(s.Reflect,P,{enumerable:!1,configurable:!1,writable:!1,value:e}),e}function je(e){var r=new K,i={isProviderFor:function(c,f){var l=r.get(c);return d(l)?!1:l.has(f)},OrdinaryDefineOwnMetadata:m,OrdinaryHasOwnMetadata:h,OrdinaryGetOwnMetadata:k,OrdinaryOwnMetadataKeys:p,OrdinaryDeleteMetadata:u};return V.registerProvider(i),i;function a(c,f,l){var y=r.get(c),_=!1;if(d(y)){if(!l)return;y=new x,r.set(c,y),_=!0}var v=y.get(f);if(d(v)){if(!l)return;if(v=new x,y.set(f,v),!e.setProvider(c,f,i))throw y.delete(f),_&&r.delete(c),new Error("Wrong provider for target.")}return v}function h(c,f,l){var y=a(f,l,!1);return d(y)?!1:oe(y.has(c))}function k(c,f,l){var y=a(f,l,!1);if(!d(y))return y.get(c)}function m(c,f,l,y){var _=a(l,y,!0);_.set(c,f)}function p(c,f){var l=[],y=a(c,f,!1);if(d(y))return l;for(var _=y.keys(),v=ce(_),O=0;;){var de=le(v);if(!de)return l.length=O,l;var Ae=fe(de);try{l[O]=Ae}catch(xe){try{he(v)}finally{throw xe}}O++}}function u(c,f,l){var y=a(f,l,!1);if(d(y)||!y.delete(c))return!1;if(y.size===0){var _=r.get(f);d(_)||(_.delete(l),_.size===0&&r.delete(_))}return!0}}function Te(e){var r=e.defineMetadata,i=e.hasOwnMetadata,a=e.getOwnMetadata,h=e.getOwnMetadataKeys,k=e.deleteMetadata,m=new K,p={isProviderFor:function(u,c){var f=m.get(u);return!d(f)&&f.has(c)?!0:h(u,c).length?(d(f)&&(f=new W,m.set(u,f)),f.add(c),!0):!1},OrdinaryDefineOwnMetadata:r,OrdinaryHasOwnMetadata:i,OrdinaryGetOwnMetadata:a,OrdinaryOwnMetadataKeys:h,OrdinaryDeleteMetadata:k};return p}function D(e,r,i){var a=V.getProvider(e,r);if(!d(a))return a;if(i){if(V.setProvider(e,r,J))return J;throw new Error("Illegal state.")}}function Ie(){var e={},r=[],i=function(){function p(u,c,f){this._index=0,this._keys=u,this._values=c,this._selector=f}return p.prototype["@@iterator"]=function(){return this},p.prototype[S]=function(){return this},p.prototype.next=function(){var u=this._index;if(u>=0&&u<this._keys.length){var c=this._selector(this._keys[u],this._values[u]);return u+1>=this._keys.length?(this._index=-1,this._keys=r,this._values=r):this._index++,{value:c,done:!1}}return{value:void 0,done:!0}},p.prototype.throw=function(u){throw this._index>=0&&(this._index=-1,this._keys=r,this._values=r),u},p.prototype.return=function(u){return this._index>=0&&(this._index=-1,this._keys=r,this._values=r),{value:u,done:!0}},p}(),a=function(){function p(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(p.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),p.prototype.has=function(u){return this._find(u,!1)>=0},p.prototype.get=function(u){var c=this._find(u,!1);return c>=0?this._values[c]:void 0},p.prototype.set=function(u,c){var f=this._find(u,!0);return this._values[f]=c,this},p.prototype.delete=function(u){var c=this._find(u,!1);if(c>=0){for(var f=this._keys.length,l=c+1;l<f;l++)this._keys[l-1]=this._keys[l],this._values[l-1]=this._values[l];return this._keys.length--,this._values.length--,N(u,this._cacheKey)&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},p.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},p.prototype.keys=function(){return new i(this._keys,this._values,h)},p.prototype.values=function(){return new i(this._keys,this._values,k)},p.prototype.entries=function(){return new i(this._keys,this._values,m)},p.prototype["@@iterator"]=function(){return this.entries()},p.prototype[S]=function(){return this.entries()},p.prototype._find=function(u,c){if(!N(this._cacheKey,u)){this._cacheIndex=-1;for(var f=0;f<this._keys.length;f++)if(N(this._keys[f],u)){this._cacheIndex=f;break}}return this._cacheIndex<0&&c&&(this._cacheIndex=this._keys.length,this._keys.push(u),this._values.push(void 0)),this._cacheIndex},p}();return a;function h(p,u){return p}function k(p,u){return u}function m(p,u){return[p,u]}}function Pe(){var e=function(){function r(){this._map=new x}return Object.defineProperty(r.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),r.prototype.has=function(i){return this._map.has(i)},r.prototype.add=function(i){return this._map.set(i,i),this},r.prototype.delete=function(i){return this._map.delete(i)},r.prototype.clear=function(){this._map.clear()},r.prototype.keys=function(){return this._map.keys()},r.prototype.values=function(){return this._map.keys()},r.prototype.entries=function(){return this._map.entries()},r.prototype["@@iterator"]=function(){return this.keys()},r.prototype[S]=function(){return this.keys()},r}();return e}function Re(){var e=16,r=E.create(),i=a();return function(){function u(){this._key=a()}return u.prototype.has=function(c){var f=h(c,!1);return f!==void 0?E.has(f,this._key):!1},u.prototype.get=function(c){var f=h(c,!1);return f!==void 0?E.get(f,this._key):void 0},u.prototype.set=function(c,f){var l=h(c,!0);return l[this._key]=f,this},u.prototype.delete=function(c){var f=h(c,!1);return f!==void 0?delete f[this._key]:!1},u.prototype.clear=function(){this._key=a()},u}();function a(){var u;do u="@@WeakMap@@"+p();while(E.has(r,u));return r[u]=!0,u}function h(u,c){if(!w.call(u,i)){if(!c)return;Object.defineProperty(u,i,{value:E.create()})}return u[i]}function k(u,c){for(var f=0;f<c;++f)u[f]=Math.random()*255|0;return u}function m(u){if(typeof Uint8Array=="function"){var c=new Uint8Array(u);return typeof crypto<"u"?crypto.getRandomValues(c):typeof msCrypto<"u"?msCrypto.getRandomValues(c):k(c,u),c}return k(new Array(u),u)}function p(){var u=m(e);u[6]=u[6]&79|64,u[8]=u[8]&191|128;for(var c="",f=0;f<e;++f){var l=u[f];(f===4||f===6||f===8)&&(c+="-"),l<16&&(c+="0"),c+=l.toString(16).toLowerCase()}return c}}function q(e){return e.__=void 0,delete e.__,e}})}(n||(n={})),Gt}xn();var $n=Object.defineProperty,Dn=(n,t,o)=>t in n?$n(n,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[t]=o,Le=(n,t,o)=>Dn(n,typeof t!="symbol"?t+"":t,o);let Fn=class{constructor(t,o){Le(this,"_target"),Le(this,"_key"),Le(this,"_oldValue"),Le(this,"_wasDefined",!1),Le(this,"_isSwapped",!1),this._target=t,this._key=o,this._oldValue=this._target[this._key]}get isSwapped(){return this._isSwapped}get originalValue(){return this._oldValue}get value(){return this._target[this._key]}get target(){return this._target}restore(){this.isSwapped&&(this._wasDefined?this._target[this._key]=this._oldValue:delete this._target[this._key],this._isSwapped=!1)}swap(t){this.isSwapped||(this._wasDefined=Object.hasOwn(this._target,this._key),this._oldValue=this._target[this._key]),this._target[this._key]=t,this._isSwapped=!0}};const Vn={onlyIfNotExists:!0,isFactory:!1};class _t{constructor(t,o,s={}){if(ot(this,"_installedInstances",new Map),ot(this,"_path"),ot(this,"_targetValue"),ot(this,"_options"),this._path=t.split("."),this._path.length===0)throw new Error("Path must not be empty");this._targetValue=o,this._options={...Vn,...s}}_getTargetObject(t){let o=t;for(const s of this._path.slice(0,this._path.length-1))o[s]||(o[s]={}),o=o[s];return o}_createSwapper(t){const o=this._getTargetObject(t);return new Fn(o,this._path.at(-1))}install({sdk:t,...o}){if(this._installedInstances.has(t))return;const s=this._createSwapper(t);if(!(s.value&&this._options.onlyIfNotExists)){if(this._options.isFactory&&typeof this._targetValue=="function"){const w=this._targetValue({sdk:t,...o});s.swap(w)}else s.swap(this._targetValue);this._installedInstances.set(t,s)}}uninstall({sdk:t}){const o=this._installedInstances.get(t);o&&(o.restore(),this._installedInstances.delete(t))}}var Cn=Object.defineProperty,zn=(n,t,o)=>t in n?Cn(n,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[t]=o,Ge=(n,t,o)=>zn(n,typeof t!="symbol"?t+"":t,o);let Jt=class{constructor(n,t){Ge(this,"_target"),Ge(this,"_key"),Ge(this,"_oldValue"),Ge(this,"_wasDefined",!1),Ge(this,"_isSwapped",!1),this._target=n,this._key=t,this._oldValue=this._target[this._key]}get isSwapped(){return this._isSwapped}get originalValue(){return this._oldValue}get value(){return this._target[this._key]}get target(){return this._target}restore(){this.isSwapped&&(this._wasDefined?this._target[this._key]=this._oldValue:delete this._target[this._key],this._isSwapped=!1)}swap(n){this.isSwapped||(this._wasDefined=Object.hasOwn(this._target,this._key),this._oldValue=this._target[this._key]),this._target[this._key]=n,this._isSwapped=!0}};function gt(){return"unsafeWindow"in window?window.unsafeWindow:window}async function Kn(n){const t=[],o=new Jt(gt().W.model.actionManager,"add");o.swap(s=>{t.push(s)});try{await n()}finally{o.restore()}return t}function Wn(n){return n.memoizedProps||{}}function Hn(n){return typeof n=="object"&&n!==null&&"memoizedState"in n&&Array.isArray(n.memoizedState)&&n.memoizedState.length===2&&"queue"in n&&n.queue===null&&Array.isArray(n.memoizedState[1])}function Nn(n){return typeof n=="object"&&n!==null&&"memoizedState"in n&&typeof n.memoizedState=="object"&&n.memoizedState!==null&&"current"in n.memoizedState&&"queue"in n&&n.queue===null}function Un(n){return typeof n=="object"&&n!==null&&"memoizedState"in n&&"queue"in n&&typeof n.queue=="object"&&n.queue!==null&&"dispatch"in n.queue&&typeof n.queue.dispatch=="function"}function qn(n){return Un(n)?{type:"useState",value:n.memoizedState,dispatch:n.queue.dispatch}:Hn(n)?{type:"useMemo",value:n.memoizedState[0],dependencies:n.memoizedState[1]}:Nn(n)?{type:"useRef",current:n.memoizedState}:null}function Ln(n,t){const o=[];let s=n.memoizedState;for(;s;){const w=qn(s);w&&o.push(w),s=s.next}return o}function Gn(n,t,o=1/0){let s=n,w=0;for(;s&&w<o;){const g=s.memoizedState?Ln(s):[],T=Wn(s),S={fiber:s,hooks:{all:g,useState:g.filter(j=>j.type==="useState"),useMemo:g.filter(j=>j.type==="useMemo"),useRef:g.filter(j=>j.type==="useRef")},props:T};if(t(S))return S;s=s.return,w++}return null}const Bn="__reactFiber$";function Jn(n){const t=Object.keys(n).find(s=>s.startsWith(Bn));if(!t)throw new Error(`No fiber key found for element: ${n}`);const o=n[t];if(!o)throw new Error(`No fiber found for element: ${n}`);return o}const Zn=n=>new Promise(t=>{const o=gt(),s=new Jt(o.W.map.olMap,"addControl");s.swap(w=>{n==null||n(w),t(w),s.restore()})});function Yn(n){const t=gt(),o=t.W.userscripts.toOLGeometry(n);return new t.OpenLayers.Feature.Vector(o)}async function Qn(n,t){const o=Gn(Jn(n),g=>"onClick"in g.props&&typeof g.props.onClick=="function");if(!o)throw new Error("No fiber found with draw initiator");const{onClick:s}=o.props;//! OpenLayers dependent code below - implementation might change over time
const w=Zn(g=>{g.activate=()=>{}});s(new Event("click")),(await w).events.triggerEvent("featureadded",{feature:Yn(t)})}var Xn=Object.defineProperty,ei=(n,t,o)=>t in n?Xn(n,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[t]=o,Zt=(n,t,o)=>ei(n,typeof t!="symbol"?t+"":t,o);function ti(){return"unsafeWindow"in window?window.unsafeWindow:window}var ri=Object.defineProperty,ni=(n,t,o)=>t in n?ri(n,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[t]=o,Fe=(n,t,o)=>ni(n,typeof t!="symbol"?t+"":t,o);let ii=class{constructor(t,o){Fe(this,"_target"),Fe(this,"_key"),Fe(this,"_oldValue"),Fe(this,"_wasDefined",!1),Fe(this,"_isSwapped",!1),this._target=t,this._key=o,this._oldValue=this._target[this._key]}get isSwapped(){return this._isSwapped}get originalValue(){return this._oldValue}get value(){return this._target[this._key]}get target(){return this._target}restore(){this.isSwapped&&(this._wasDefined?this._target[this._key]=this._oldValue:delete this._target[this._key],this._isSwapped=!1)}swap(t){this.isSwapped||(this._wasDefined=Object.hasOwn(this._target,this._key),this._oldValue=this._target[this._key]),this._target[this._key]=t,this._isSwapped=!0}},oi=class{constructor(t,o,s){Fe(this,"_enabled",!1),Fe(this,"_fnSwapper"),Fe(this,"_interceptionFunction"),Fe(this,"_middlewares",[]),this._fnSwapper=new ii(t,o),this._interceptionFunction=s}get enabled(){return this._fnSwapper.isSwapped&&this._enabled}disable(){this._enabled=!1,this.enabled}restore(){this._fnSwapper.restore()}enable(){this._enabled=!0,this._fnSwapper.isSwapped||this.swapToInterceptor()}swapToInterceptor(){const t=this;this._fnSwapper.swap(function(...o){if(!t._enabled)return t.callOriginalInvocator(...o);const s=t.runMiddlewares(o);if(s){if("output"in s)return s.output;"input"in s&&(o=s.input)}return t._interceptionFunction.call(this,t.getOriginalInvocator(this),...o)})}getOriginalInvocator(t){return this._fnSwapper.originalValue.bind(t??this._fnSwapper.target)}callOriginalInvocator(...t){return this.getOriginalInvocator()(...t)}runMiddlewares(t){for(const o of this._middlewares){const s=o(...t);if(s){if("output"in s)return s;"input"in s&&(t=s.input)}}return{input:t}}registerMiddleware(t){this._middlewares.push(t)}},ai=class{constructor(t){Zt(this,"_fetchInterceptor"),Zt(this,"_interceptionFilters",new Set),this._fetchInterceptor=new oi(t,"fetch",(o,s,w)=>{for(const g of this._interceptionFilters)if(g.shouldIntercept(s,w))return this.shouldKeepFilter(g,s,w)||this.removeInterceptionFilter(g),g.intercept(s,w);return o(s,w)})}enable(){this._fetchInterceptor.enable()}disable(){this._fetchInterceptor.disable()}addInterceptionFilter(t){this.enable(),this._interceptionFilters.add(t)}removeInterceptionFilter(t){this._interceptionFilters.delete(t)}shouldKeepFilter(t,o,s){return typeof t.shouldKeep=="function"?t.shouldKeep(o,s):typeof t.shouldKeep=="boolean"?t.shouldKeep:!1}};new ai(ti());function si(n,t,o={}){const s={type:"Feature"};return(o.id===0||o.id)&&(s.id=o.id),o.bbox&&(s.bbox=o.bbox),s.properties={},s.geometry=n,s}function ui(n,t,o={}){for(const s of n){if(s.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(s[s.length-1].length!==s[0].length)throw new Error("First and last Position are not equivalent.");for(let w=0;w<s[s.length-1].length;w++)if(s[s.length-1][w]!==s[0][w])throw new Error("First and last Position are not equivalent.")}return si({type:"Polygon",coordinates:n},t,o)}function at(){return"unsafeWindow"in window?window.unsafeWindow:window}function ci(n,t,o){const s=new n(o),w=new t(s);return at().W.model.actionManager.add(w),s}function Yt(n){return at().W.model.permanentHazards.getObjectById(n)}function fi(n,t){const o=at().require("Waze/Action/UpdateObject");return new o(n,t)}function li(n,t){at().W.model.actionManager.add(fi(n,t))}function hi(n){return Object.fromEntries(Object.entries(n).filter(([,t])=>t!==void 0))}let vt,bt;const di=[{async install(){const n=document.querySelector("#drawer wz-menu > wz-menu-sub-menu:nth-child(3) > wz-menu-item:nth-of-type(2)");if(!n||!(n instanceof HTMLElement))throw new Error("Unable to find school zone drawing menu item");const[t]=await Kn(async()=>{await Qn(n,ui([[[0,0],[0,1],[1,1],[0,0]]]).geometry)});if(t.actionName!=="ADD_PERMANENT_HAZARD")throw new Error("Unexpected action discovered when tried to resolve AddPermanentHazard action: "+t.actionName);const o=t.object;if(!o)throw new Error("Unexpected state: Added object does not exist");if(o.type!=="permanentHazard")throw new Error("Unexpected state: Expected the added object to be a PermanentHazard instead of "+t.type);vt=t.constructor,bt=o.constructor}},new _t("DataModel.PermanentHazards.addSchoolZone",n=>{if(!bt||!vt)throw new Error("PermanentHazard or AddPermanentHazard are not initialized. Make sure to await the enhancedSDK function before using it.");return ci(bt,vt,{type:9,geoJSONGeometry:n.geometry,name:n.name,speedLimit:n.speedLimit,excludedRoadTypes:n.excludedRoadTypes}).getID()}),new _t("DataModel.PermanentHazards.updateSchoolZone",({sdkInstance:n})=>t=>{const o=Yt(t.schoolZoneId);if(!o||o.getAttribute("type")!==9)throw new n.Errors.DataModelNotFoundError("permanentHazard.SchoolZone",t.schoolZoneId);li(o,hi({geoJSONGeometry:t.geometry,name:t.name,speedLimit:t.speedLimit,excludedRoadTypes:t.excludedRoadTypes}))},{isFactory:!0}),new _t("DataModel.PermanentHazards.getSchoolZoneById",()=>n=>{const t=Yt(n.schoolZoneId);return!t||t.getAttribute("type")!==9?null:t},{isFactory:!0})];var pi=Object.defineProperty,yi=(n,t,o)=>t in n?pi(n,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[t]=o,st=(n,t,o)=>yi(n,typeof t!="symbol"?t+"":t,o),Qt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Xt={};/*! *****************************************************************************
  Copyright (C) Microsoft. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0

  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.

  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */var er;function wi(){if(er)return Xt;er=1;var n;return function(t){(function(o){var s=typeof globalThis=="object"?globalThis:typeof Qt=="object"?Qt:typeof self=="object"?self:typeof this=="object"?this:j(),w=g(t);typeof s.Reflect<"u"&&(w=g(s.Reflect,w)),o(w,s),typeof s.Reflect>"u"&&(s.Reflect=t);function g($,I){return function(E,A){Object.defineProperty($,E,{configurable:!0,writable:!0,value:A}),I&&I(E,A)}}function T(){try{return Function("return this;")()}catch{}}function S(){try{return(0,eval)("(function() { return this; })()")}catch{}}function j(){return T()||S()}})(function(o,s){var w=Object.prototype.hasOwnProperty,g=typeof Symbol=="function",T=g&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",S=g&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",j=typeof Object.create=="function",$={__proto__:[]}instanceof Array,I=!j&&!$,E={create:j?function(){return q(Object.create(null))}:$?function(){return q({__proto__:null})}:function(){return q({})},has:I?function(e,r){return w.call(e,r)}:function(e,r){return r in e},get:I?function(e,r){return w.call(e,r)?e[r]:void 0}:function(e,r){return e[r]}},A=Object.getPrototypeOf(Function),x=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:Ie(),W=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Pe(),K=typeof WeakMap=="function"?WeakMap:Re(),P=g?Symbol.for("@reflect-metadata:registry"):void 0,V=Ee(),J=je(V);function we(e,r,i,a){if(d(i)){if(!ae(e))throw new TypeError;if(!se(r))throw new TypeError;return ge(e,r)}else{if(!ae(e))throw new TypeError;if(!b(r))throw new TypeError;if(!b(a)&&!d(a)&&!R(a))throw new TypeError;return R(a)&&(a=void 0),i=M(i),ve(e,r,i,a)}}o("decorate",we);function F(e,r){function i(a,h){if(!b(a))throw new TypeError;if(!d(h)&&!Se(h))throw new TypeError;te(e,r,a,h)}return i}o("metadata",F);function C(e,r,i,a){if(!b(i))throw new TypeError;return d(a)||(a=M(a)),te(e,r,i,a)}o("defineMetadata",C);function L(e,r,i){if(!b(r))throw new TypeError;return d(i)||(i=M(i)),Q(e,r,i)}o("hasMetadata",L);function G(e,r,i){if(!b(r))throw new TypeError;return d(i)||(i=M(i)),H(e,r,i)}o("hasOwnMetadata",G);function ye(e,r,i){if(!b(r))throw new TypeError;return d(i)||(i=M(i)),X(e,r,i)}o("getMetadata",ye);function Z(e,r,i){if(!b(r))throw new TypeError;return d(i)||(i=M(i)),ee(e,r,i)}o("getOwnMetadata",Z);function Y(e,r){if(!b(e))throw new TypeError;return d(r)||(r=M(r)),re(e,r)}o("getMetadataKeys",Y);function pe(e,r){if(!b(e))throw new TypeError;return d(r)||(r=M(r)),ne(e,r)}o("getOwnMetadataKeys",pe);function _e(e,r,i){if(!b(r))throw new TypeError;if(d(i)||(i=M(i)),!b(r))throw new TypeError;d(i)||(i=M(i));var a=D(r,i,!1);return d(a)?!1:a.OrdinaryDeleteMetadata(e,r,i)}o("deleteMetadata",_e);function ge(e,r){for(var i=e.length-1;i>=0;--i){var a=e[i],h=a(r);if(!d(h)&&!R(h)){if(!se(h))throw new TypeError;r=h}}return r}function ve(e,r,i,a){for(var h=e.length-1;h>=0;--h){var k=e[h],m=k(r,i,a);if(!d(m)&&!R(m)){if(!b(m))throw new TypeError;a=m}}return a}function Q(e,r,i){var a=H(e,r,i);if(a)return!0;var h=U(r);return R(h)?!1:Q(e,h,i)}function H(e,r,i){var a=D(r,i,!1);return d(a)?!1:oe(a.OrdinaryHasOwnMetadata(e,r,i))}function X(e,r,i){var a=H(e,r,i);if(a)return ee(e,r,i);var h=U(r);if(!R(h))return X(e,h,i)}function ee(e,r,i){var a=D(r,i,!1);if(!d(a))return a.OrdinaryGetOwnMetadata(e,r,i)}function te(e,r,i,a){var h=D(i,a,!0);h.OrdinaryDefineOwnMetadata(e,r,i,a)}function re(e,r){var i=ne(e,r),a=U(e);if(a===null)return i;var h=re(a,r);if(h.length<=0)return i;if(i.length<=0)return h;for(var k=new W,m=[],p=0,u=i;p<u.length;p++){var c=u[p],f=k.has(c);f||(k.add(c),m.push(c))}for(var l=0,y=h;l<y.length;l++){var c=y[l],f=k.has(c);f||(k.add(c),m.push(c))}return m}function ne(e,r){var i=D(e,r,!1);return i?i.OrdinaryOwnMetadataKeys(e,r):[]}function ie(e){if(e===null)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return e===null?1:6;default:return 6}}function d(e){return e===void 0}function R(e){return e===null}function be(e){return typeof e=="symbol"}function b(e){return typeof e=="object"?e!==null:typeof e=="function"}function me(e,r){switch(ie(e)){case 0:return e;case 1:return e;case 2:return e;case 3:return e;case 4:return e;case 5:return e}var i="string",a=ue(e,T);if(a!==void 0){var h=a.call(e,i);if(b(h))throw new TypeError;return h}return ke(e)}function ke(e,r){var i,a;{var h=e.toString;if(z(h)){var a=h.call(e);if(!b(a))return a}var i=e.valueOf;if(z(i)){var a=i.call(e);if(!b(a))return a}}throw new TypeError}function oe(e){return!!e}function Oe(e){return""+e}function M(e){var r=me(e);return be(r)?r:Oe(r)}function ae(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:Object.prototype.toString.call(e)==="[object Array]"}function z(e){return typeof e=="function"}function se(e){return typeof e=="function"}function Se(e){switch(ie(e)){case 3:return!0;case 4:return!0;default:return!1}}function N(e,r){return e===r||e!==e&&r!==r}function ue(e,r){var i=e[r];if(i!=null){if(!z(i))throw new TypeError;return i}}function ce(e){var r=ue(e,S);if(!z(r))throw new TypeError;var i=r.call(e);if(!b(i))throw new TypeError;return i}function fe(e){return e.value}function le(e){var r=e.next();return r.done?!1:r}function he(e){var r=e.return;r&&r.call(e)}function U(e){var r=Object.getPrototypeOf(e);if(typeof e!="function"||e===A||r!==A)return r;var i=e.prototype,a=i&&Object.getPrototypeOf(i);if(a==null||a===Object.prototype)return r;var h=a.constructor;return typeof h!="function"||h===e?r:h}function Me(){var e;!d(P)&&typeof s.Reflect<"u"&&!(P in s.Reflect)&&typeof s.Reflect.defineMetadata=="function"&&(e=Te(s.Reflect));var r,i,a,h=new K,k={registerProvider:m,getProvider:u,setProvider:f};return k;function m(l){if(!Object.isExtensible(k))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case e===l:break;case d(r):r=l;break;case r===l:break;case d(i):i=l;break;case i===l:break;default:a===void 0&&(a=new W),a.add(l);break}}function p(l,y){if(!d(r)){if(r.isProviderFor(l,y))return r;if(!d(i)){if(i.isProviderFor(l,y))return r;if(!d(a))for(var _=ce(a);;){var v=le(_);if(!v)return;var O=fe(v);if(O.isProviderFor(l,y))return he(_),O}}}if(!d(e)&&e.isProviderFor(l,y))return e}function u(l,y){var _=h.get(l),v;return d(_)||(v=_.get(y)),d(v)&&(v=p(l,y),d(v)||(d(_)&&(_=new x,h.set(l,_)),_.set(y,v))),v}function c(l){if(d(l))throw new TypeError;return r===l||i===l||!d(a)&&a.has(l)}function f(l,y,_){if(!c(_))throw new Error("Metadata provider not registered.");var v=u(l,y);if(v!==_){if(!d(v))return!1;var O=h.get(l);d(O)&&(O=new x,h.set(l,O)),O.set(y,_)}return!0}}function Ee(){var e;return!d(P)&&b(s.Reflect)&&Object.isExtensible(s.Reflect)&&(e=s.Reflect[P]),d(e)&&(e=Me()),!d(P)&&b(s.Reflect)&&Object.isExtensible(s.Reflect)&&Object.defineProperty(s.Reflect,P,{enumerable:!1,configurable:!1,writable:!1,value:e}),e}function je(e){var r=new K,i={isProviderFor:function(c,f){var l=r.get(c);return d(l)?!1:l.has(f)},OrdinaryDefineOwnMetadata:m,OrdinaryHasOwnMetadata:h,OrdinaryGetOwnMetadata:k,OrdinaryOwnMetadataKeys:p,OrdinaryDeleteMetadata:u};return V.registerProvider(i),i;function a(c,f,l){var y=r.get(c),_=!1;if(d(y)){if(!l)return;y=new x,r.set(c,y),_=!0}var v=y.get(f);if(d(v)){if(!l)return;if(v=new x,y.set(f,v),!e.setProvider(c,f,i))throw y.delete(f),_&&r.delete(c),new Error("Wrong provider for target.")}return v}function h(c,f,l){var y=a(f,l,!1);return d(y)?!1:oe(y.has(c))}function k(c,f,l){var y=a(f,l,!1);if(!d(y))return y.get(c)}function m(c,f,l,y){var _=a(l,y,!0);_.set(c,f)}function p(c,f){var l=[],y=a(c,f,!1);if(d(y))return l;for(var _=y.keys(),v=ce(_),O=0;;){var de=le(v);if(!de)return l.length=O,l;var Ae=fe(de);try{l[O]=Ae}catch(xe){try{he(v)}finally{throw xe}}O++}}function u(c,f,l){var y=a(f,l,!1);if(d(y)||!y.delete(c))return!1;if(y.size===0){var _=r.get(f);d(_)||(_.delete(l),_.size===0&&r.delete(_))}return!0}}function Te(e){var r=e.defineMetadata,i=e.hasOwnMetadata,a=e.getOwnMetadata,h=e.getOwnMetadataKeys,k=e.deleteMetadata,m=new K,p={isProviderFor:function(u,c){var f=m.get(u);return!d(f)&&f.has(c)?!0:h(u,c).length?(d(f)&&(f=new W,m.set(u,f)),f.add(c),!0):!1},OrdinaryDefineOwnMetadata:r,OrdinaryHasOwnMetadata:i,OrdinaryGetOwnMetadata:a,OrdinaryOwnMetadataKeys:h,OrdinaryDeleteMetadata:k};return p}function D(e,r,i){var a=V.getProvider(e,r);if(!d(a))return a;if(i){if(V.setProvider(e,r,J))return J;throw new Error("Illegal state.")}}function Ie(){var e={},r=[],i=function(){function p(u,c,f){this._index=0,this._keys=u,this._values=c,this._selector=f}return p.prototype["@@iterator"]=function(){return this},p.prototype[S]=function(){return this},p.prototype.next=function(){var u=this._index;if(u>=0&&u<this._keys.length){var c=this._selector(this._keys[u],this._values[u]);return u+1>=this._keys.length?(this._index=-1,this._keys=r,this._values=r):this._index++,{value:c,done:!1}}return{value:void 0,done:!0}},p.prototype.throw=function(u){throw this._index>=0&&(this._index=-1,this._keys=r,this._values=r),u},p.prototype.return=function(u){return this._index>=0&&(this._index=-1,this._keys=r,this._values=r),{value:u,done:!0}},p}(),a=function(){function p(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(p.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),p.prototype.has=function(u){return this._find(u,!1)>=0},p.prototype.get=function(u){var c=this._find(u,!1);return c>=0?this._values[c]:void 0},p.prototype.set=function(u,c){var f=this._find(u,!0);return this._values[f]=c,this},p.prototype.delete=function(u){var c=this._find(u,!1);if(c>=0){for(var f=this._keys.length,l=c+1;l<f;l++)this._keys[l-1]=this._keys[l],this._values[l-1]=this._values[l];return this._keys.length--,this._values.length--,N(u,this._cacheKey)&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},p.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},p.prototype.keys=function(){return new i(this._keys,this._values,h)},p.prototype.values=function(){return new i(this._keys,this._values,k)},p.prototype.entries=function(){return new i(this._keys,this._values,m)},p.prototype["@@iterator"]=function(){return this.entries()},p.prototype[S]=function(){return this.entries()},p.prototype._find=function(u,c){if(!N(this._cacheKey,u)){this._cacheIndex=-1;for(var f=0;f<this._keys.length;f++)if(N(this._keys[f],u)){this._cacheIndex=f;break}}return this._cacheIndex<0&&c&&(this._cacheIndex=this._keys.length,this._keys.push(u),this._values.push(void 0)),this._cacheIndex},p}();return a;function h(p,u){return p}function k(p,u){return u}function m(p,u){return[p,u]}}function Pe(){var e=function(){function r(){this._map=new x}return Object.defineProperty(r.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),r.prototype.has=function(i){return this._map.has(i)},r.prototype.add=function(i){return this._map.set(i,i),this},r.prototype.delete=function(i){return this._map.delete(i)},r.prototype.clear=function(){this._map.clear()},r.prototype.keys=function(){return this._map.keys()},r.prototype.values=function(){return this._map.keys()},r.prototype.entries=function(){return this._map.entries()},r.prototype["@@iterator"]=function(){return this.keys()},r.prototype[S]=function(){return this.keys()},r}();return e}function Re(){var e=16,r=E.create(),i=a();return function(){function u(){this._key=a()}return u.prototype.has=function(c){var f=h(c,!1);return f!==void 0?E.has(f,this._key):!1},u.prototype.get=function(c){var f=h(c,!1);return f!==void 0?E.get(f,this._key):void 0},u.prototype.set=function(c,f){var l=h(c,!0);return l[this._key]=f,this},u.prototype.delete=function(c){var f=h(c,!1);return f!==void 0?delete f[this._key]:!1},u.prototype.clear=function(){this._key=a()},u}();function a(){var u;do u="@@WeakMap@@"+p();while(E.has(r,u));return r[u]=!0,u}function h(u,c){if(!w.call(u,i)){if(!c)return;Object.defineProperty(u,i,{value:E.create()})}return u[i]}function k(u,c){for(var f=0;f<c;++f)u[f]=Math.random()*255|0;return u}function m(u){if(typeof Uint8Array=="function"){var c=new Uint8Array(u);return typeof crypto<"u"?crypto.getRandomValues(c):typeof msCrypto<"u"?msCrypto.getRandomValues(c):k(c,u),c}return k(new Array(u),u)}function p(){var u=m(e);u[6]=u[6]&79|64,u[8]=u[8]&191|128;for(var c="",f=0;f<e;++f){var l=u[f];(f===4||f===6||f===8)&&(c+="-"),l<16&&(c+="0"),c+=l.toString(16).toLowerCase()}return c}}function q(e){return e.__=void 0,delete e.__,e}})}(n||(n={})),Xt}wi();var _i=Object.defineProperty,gi=(n,t,o)=>t in n?_i(n,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[t]=o,Be=(n,t,o)=>gi(n,typeof t!="symbol"?t+"":t,o);let vi=class{constructor(t,o){Be(this,"_target"),Be(this,"_key"),Be(this,"_oldValue"),Be(this,"_wasDefined",!1),Be(this,"_isSwapped",!1),this._target=t,this._key=o,this._oldValue=this._target[this._key]}get isSwapped(){return this._isSwapped}get originalValue(){return this._oldValue}get value(){return this._target[this._key]}get target(){return this._target}restore(){this.isSwapped&&(this._wasDefined?this._target[this._key]=this._oldValue:delete this._target[this._key],this._isSwapped=!1)}swap(t){this.isSwapped||(this._wasDefined=Object.hasOwn(this._target,this._key),this._oldValue=this._target[this._key]),this._target[this._key]=t,this._isSwapped=!0}};const bi={onlyIfNotExists:!0,isFactory:!1};let mi=class{constructor(t,o,s={}){if(st(this,"_installedInstances",new Map),st(this,"_path"),st(this,"_targetValue"),st(this,"_options"),this._path=t.split("."),this._path.length===0)throw new Error("Path must not be empty");this._targetValue=o,this._options={...bi,...s}}_getTargetObject(t){let o=t;for(const s of this._path.slice(0,this._path.length-1))o[s]||(o[s]={}),o=o[s];return o}_createSwapper(t){const o=this._getTargetObject(t);return new vi(o,this._path.at(-1))}install({sdk:t,...o}){if(this._installedInstances.has(t))return;const s=this._createSwapper(t);if(!(s.value&&this._options.onlyIfNotExists)){if(this._options.isFactory&&typeof this._targetValue=="function"){const w=this._targetValue({sdk:t,...o});s.swap(w)}else s.swap(this._targetValue);this._installedInstances.set(t,s)}}uninstall({sdk:t}){const o=this._installedInstances.get(t);o&&(o.restore(),this._installedInstances.delete(t))}};const tr=Symbol("BigJunction"),rr=Symbol("AddBigJunction");function ki(){return"unsafeWindow"in window?window.unsafeWindow:window}function Oi(n,t,o){const s=new n(o),w=new t(s);return ki().W.model.actionManager.add(w),s}const Si=[new mi("DataModel.BigJunctions.addBigJunction",({artifacts:n})=>t=>Oi(n[tr],n[rr],{geoJSONGeometry:t.geometry}).getID(),{isFactory:!0})];function Mi(n,t,o={}){const s={type:"Feature"};return(o.id===0||o.id)&&(s.id=o.id),o.bbox&&(s.bbox=o.bbox),s.properties={},s.geometry=n,s}function Ei(n,t,o={}){for(const s of n){if(s.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(s[s.length-1].length!==s[0].length)throw new Error("First and last Position are not equivalent.");for(let w=0;w<s[s.length-1].length;w++)if(s[s.length-1][w]!==s[0][w])throw new Error("First and last Position are not equivalent.")}return Mi({type:"Polygon",coordinates:n},t,o)}var ji=Object.defineProperty,Ti=(n,t,o)=>t in n?ji(n,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[t]=o,Je=(n,t,o)=>Ti(n,typeof t!="symbol"?t+"":t,o);let nr=class{constructor(t,o){Je(this,"_target"),Je(this,"_key"),Je(this,"_oldValue"),Je(this,"_wasDefined",!1),Je(this,"_isSwapped",!1),this._target=t,this._key=o,this._oldValue=this._target[this._key]}get isSwapped(){return this._isSwapped}get originalValue(){return this._oldValue}get value(){return this._target[this._key]}get target(){return this._target}restore(){this.isSwapped&&(this._wasDefined?this._target[this._key]=this._oldValue:delete this._target[this._key],this._isSwapped=!1)}swap(t){this.isSwapped||(this._wasDefined=Object.hasOwn(this._target,this._key),this._oldValue=this._target[this._key]),this._target[this._key]=t,this._isSwapped=!0}};function mt(){return"unsafeWindow"in window?window.unsafeWindow:window}async function Ii(n){const t=[],o=new nr(mt().W.model.actionManager,"add");o.swap(s=>{t.push(s)});try{await n()}finally{o.restore()}return t}function Pi(n){return n.memoizedProps||{}}function Ri(n){return typeof n=="object"&&n!==null&&"memoizedState"in n&&Array.isArray(n.memoizedState)&&n.memoizedState.length===2&&"queue"in n&&n.queue===null&&Array.isArray(n.memoizedState[1])}function Ai(n){return typeof n=="object"&&n!==null&&"memoizedState"in n&&typeof n.memoizedState=="object"&&n.memoizedState!==null&&"current"in n.memoizedState&&"queue"in n&&n.queue===null}function xi(n){return typeof n=="object"&&n!==null&&"memoizedState"in n&&"queue"in n&&typeof n.queue=="object"&&n.queue!==null&&"dispatch"in n.queue&&typeof n.queue.dispatch=="function"}function $i(n){return xi(n)?{type:"useState",value:n.memoizedState,dispatch:n.queue.dispatch}:Ri(n)?{type:"useMemo",value:n.memoizedState[0],dependencies:n.memoizedState[1]}:Ai(n)?{type:"useRef",current:n.memoizedState}:null}function Di(n,t){const o=[];let s=n.memoizedState;for(;s;){const w=$i(s);w&&o.push(w),s=s.next}return o}function Fi(n,t,o=1/0){let s=n,w=0;for(;s&&w<o;){const g=s.memoizedState?Di(s):[],T=Pi(s),S={fiber:s,hooks:{all:g,useState:g.filter(j=>j.type==="useState"),useMemo:g.filter(j=>j.type==="useMemo"),useRef:g.filter(j=>j.type==="useRef")},props:T};if(t(S))return S;s=s.return,w++}return null}const Vi="__reactFiber$";function Ci(n){const t=Object.keys(n).find(s=>s.startsWith(Vi));if(!t)throw new Error(`No fiber key found for element: ${n}`);const o=n[t];if(!o)throw new Error(`No fiber found for element: ${n}`);return o}const zi=n=>new Promise(t=>{const o=mt(),s=new nr(o.W.map.olMap,"addControl");s.swap(w=>{n==null||n(w),t(w),s.restore()})});function Ki(n){const t=mt(),o=t.W.userscripts.toOLGeometry(n);return new t.OpenLayers.Feature.Vector(o)}async function Wi(n,t){const o=Fi(Ci(n),g=>"onClick"in g.props&&typeof g.props.onClick=="function");if(!o)throw new Error("No fiber found with draw initiator");const{onClick:s}=o.props;//! OpenLayers dependent code below - implementation might change over time
const w=zi(g=>{g.activate=()=>{}});s(new Event("click")),(await w).events.triggerEvent("featureadded",{feature:Ki(t)})}var Hi=Object.defineProperty,Ni=(n,t,o)=>t in n?Hi(n,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[t]=o,ir=(n,t,o)=>Ni(n,typeof t!="symbol"?t+"":t,o);function Ui(){return"unsafeWindow"in window?window.unsafeWindow:window}var qi=Object.defineProperty,Li=(n,t,o)=>t in n?qi(n,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[t]=o,Ve=(n,t,o)=>Li(n,typeof t!="symbol"?t+"":t,o);let Gi=class{constructor(t,o){Ve(this,"_target"),Ve(this,"_key"),Ve(this,"_oldValue"),Ve(this,"_wasDefined",!1),Ve(this,"_isSwapped",!1),this._target=t,this._key=o,this._oldValue=this._target[this._key]}get isSwapped(){return this._isSwapped}get originalValue(){return this._oldValue}get value(){return this._target[this._key]}get target(){return this._target}restore(){this.isSwapped&&(this._wasDefined?this._target[this._key]=this._oldValue:delete this._target[this._key],this._isSwapped=!1)}swap(t){this.isSwapped||(this._wasDefined=Object.hasOwn(this._target,this._key),this._oldValue=this._target[this._key]),this._target[this._key]=t,this._isSwapped=!0}},Bi=class{constructor(t,o,s){Ve(this,"_enabled",!1),Ve(this,"_fnSwapper"),Ve(this,"_interceptionFunction"),Ve(this,"_middlewares",[]),this._fnSwapper=new Gi(t,o),this._interceptionFunction=s}get enabled(){return this._fnSwapper.isSwapped&&this._enabled}disable(){this._enabled=!1,this.enabled}restore(){this._fnSwapper.restore()}enable(){this._enabled=!0,this._fnSwapper.isSwapped||this.swapToInterceptor()}swapToInterceptor(){const t=this;this._fnSwapper.swap(function(...o){if(!t._enabled)return t.callOriginalInvocator(...o);const s=t.runMiddlewares(o);if(s){if("output"in s)return s.output;"input"in s&&(o=s.input)}return t._interceptionFunction.call(this,t.getOriginalInvocator(this),...o)})}getOriginalInvocator(t){return this._fnSwapper.originalValue.bind(t??this._fnSwapper.target)}callOriginalInvocator(...t){return this.getOriginalInvocator()(...t)}runMiddlewares(t){for(const o of this._middlewares){const s=o(...t);if(s){if("output"in s)return s;"input"in s&&(t=s.input)}}return{input:t}}registerMiddleware(t){this._middlewares.push(t)}},Ji=class{constructor(t){ir(this,"_fetchInterceptor"),ir(this,"_interceptionFilters",new Set),this._fetchInterceptor=new Bi(t,"fetch",(o,s,w)=>{for(const g of this._interceptionFilters)if(g.shouldIntercept(s,w))return this.shouldKeepFilter(g,s,w)||this.removeInterceptionFilter(g),g.intercept(s,w);return o(s,w)})}enable(){this._fetchInterceptor.enable()}disable(){this._fetchInterceptor.disable()}addInterceptionFilter(t){this.enable(),this._interceptionFilters.add(t)}removeInterceptionFilter(t){this._interceptionFilters.delete(t)}shouldKeepFilter(t,o,s){return typeof t.shouldKeep=="function"?t.shouldKeep(o,s):typeof t.shouldKeep=="boolean"?t.shouldKeep:!1}};new Ji(Ui());const Zi=[{async install(){const n=document.querySelector("#drawer wz-menu > wz-menu-sub-menu:nth-child(1) > wz-menu-item:nth-of-type(4)");if(!n||!(n instanceof HTMLElement))throw new Error("Unable to find school zone drawing menu item");const[t]=await Ii(async()=>{await Wi(n,Ei([[[0,0],[0,1],[1,1],[0,0]]]).geometry)});if(t.actionName!=="ADD_BIG_JUNCTION")throw new Error("Unexpected action discovered when tried to resolve AddBigJunction action: "+t.actionName);const o=t.bigJunction;if(!o)throw new Error("Unexpected state: Added object does not exist");if(o.type!=="bigJunction")throw new Error("Unexpected state: Expected the added object to be a BigJunction instead of "+t.type);return{[tr]:o.constructor,[rr]:t.constructor}}}],Yi=[...Zi,...Si];var Qi=Object.defineProperty,Xi=(n,t,o)=>t in n?Qi(n,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[t]=o,B=(n,t,o)=>Xi(n,typeof t!="symbol"?t+"":t,o),eo=Object.defineProperty,to=(n,t,o)=>t in n?eo(n,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[t]=o,ut=(n,t,o)=>to(n,typeof t!="symbol"?t+"":t,o),or=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ar={};/*! *****************************************************************************
  Copyright (C) Microsoft. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0

  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.

  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */var sr;function ro(){if(sr)return ar;sr=1;var n;return function(t){(function(o){var s=typeof globalThis=="object"?globalThis:typeof or=="object"?or:typeof self=="object"?self:typeof this=="object"?this:j(),w=g(t);typeof s.Reflect<"u"&&(w=g(s.Reflect,w)),o(w,s),typeof s.Reflect>"u"&&(s.Reflect=t);function g($,I){return function(E,A){Object.defineProperty($,E,{configurable:!0,writable:!0,value:A}),I&&I(E,A)}}function T(){try{return Function("return this;")()}catch{}}function S(){try{return(0,eval)("(function() { return this; })()")}catch{}}function j(){return T()||S()}})(function(o,s){var w=Object.prototype.hasOwnProperty,g=typeof Symbol=="function",T=g&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",S=g&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",j=typeof Object.create=="function",$={__proto__:[]}instanceof Array,I=!j&&!$,E={create:j?function(){return q(Object.create(null))}:$?function(){return q({__proto__:null})}:function(){return q({})},has:I?function(e,r){return w.call(e,r)}:function(e,r){return r in e},get:I?function(e,r){return w.call(e,r)?e[r]:void 0}:function(e,r){return e[r]}},A=Object.getPrototypeOf(Function),x=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:Ie(),W=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Pe(),K=typeof WeakMap=="function"?WeakMap:Re(),P=g?Symbol.for("@reflect-metadata:registry"):void 0,V=Ee(),J=je(V);function we(e,r,i,a){if(d(i)){if(!ae(e))throw new TypeError;if(!se(r))throw new TypeError;return ge(e,r)}else{if(!ae(e))throw new TypeError;if(!b(r))throw new TypeError;if(!b(a)&&!d(a)&&!R(a))throw new TypeError;return R(a)&&(a=void 0),i=M(i),ve(e,r,i,a)}}o("decorate",we);function F(e,r){function i(a,h){if(!b(a))throw new TypeError;if(!d(h)&&!Se(h))throw new TypeError;te(e,r,a,h)}return i}o("metadata",F);function C(e,r,i,a){if(!b(i))throw new TypeError;return d(a)||(a=M(a)),te(e,r,i,a)}o("defineMetadata",C);function L(e,r,i){if(!b(r))throw new TypeError;return d(i)||(i=M(i)),Q(e,r,i)}o("hasMetadata",L);function G(e,r,i){if(!b(r))throw new TypeError;return d(i)||(i=M(i)),H(e,r,i)}o("hasOwnMetadata",G);function ye(e,r,i){if(!b(r))throw new TypeError;return d(i)||(i=M(i)),X(e,r,i)}o("getMetadata",ye);function Z(e,r,i){if(!b(r))throw new TypeError;return d(i)||(i=M(i)),ee(e,r,i)}o("getOwnMetadata",Z);function Y(e,r){if(!b(e))throw new TypeError;return d(r)||(r=M(r)),re(e,r)}o("getMetadataKeys",Y);function pe(e,r){if(!b(e))throw new TypeError;return d(r)||(r=M(r)),ne(e,r)}o("getOwnMetadataKeys",pe);function _e(e,r,i){if(!b(r))throw new TypeError;if(d(i)||(i=M(i)),!b(r))throw new TypeError;d(i)||(i=M(i));var a=D(r,i,!1);return d(a)?!1:a.OrdinaryDeleteMetadata(e,r,i)}o("deleteMetadata",_e);function ge(e,r){for(var i=e.length-1;i>=0;--i){var a=e[i],h=a(r);if(!d(h)&&!R(h)){if(!se(h))throw new TypeError;r=h}}return r}function ve(e,r,i,a){for(var h=e.length-1;h>=0;--h){var k=e[h],m=k(r,i,a);if(!d(m)&&!R(m)){if(!b(m))throw new TypeError;a=m}}return a}function Q(e,r,i){var a=H(e,r,i);if(a)return!0;var h=U(r);return R(h)?!1:Q(e,h,i)}function H(e,r,i){var a=D(r,i,!1);return d(a)?!1:oe(a.OrdinaryHasOwnMetadata(e,r,i))}function X(e,r,i){var a=H(e,r,i);if(a)return ee(e,r,i);var h=U(r);if(!R(h))return X(e,h,i)}function ee(e,r,i){var a=D(r,i,!1);if(!d(a))return a.OrdinaryGetOwnMetadata(e,r,i)}function te(e,r,i,a){var h=D(i,a,!0);h.OrdinaryDefineOwnMetadata(e,r,i,a)}function re(e,r){var i=ne(e,r),a=U(e);if(a===null)return i;var h=re(a,r);if(h.length<=0)return i;if(i.length<=0)return h;for(var k=new W,m=[],p=0,u=i;p<u.length;p++){var c=u[p],f=k.has(c);f||(k.add(c),m.push(c))}for(var l=0,y=h;l<y.length;l++){var c=y[l],f=k.has(c);f||(k.add(c),m.push(c))}return m}function ne(e,r){var i=D(e,r,!1);return i?i.OrdinaryOwnMetadataKeys(e,r):[]}function ie(e){if(e===null)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return e===null?1:6;default:return 6}}function d(e){return e===void 0}function R(e){return e===null}function be(e){return typeof e=="symbol"}function b(e){return typeof e=="object"?e!==null:typeof e=="function"}function me(e,r){switch(ie(e)){case 0:return e;case 1:return e;case 2:return e;case 3:return e;case 4:return e;case 5:return e}var i="string",a=ue(e,T);if(a!==void 0){var h=a.call(e,i);if(b(h))throw new TypeError;return h}return ke(e)}function ke(e,r){var i,a;{var h=e.toString;if(z(h)){var a=h.call(e);if(!b(a))return a}var i=e.valueOf;if(z(i)){var a=i.call(e);if(!b(a))return a}}throw new TypeError}function oe(e){return!!e}function Oe(e){return""+e}function M(e){var r=me(e);return be(r)?r:Oe(r)}function ae(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:Object.prototype.toString.call(e)==="[object Array]"}function z(e){return typeof e=="function"}function se(e){return typeof e=="function"}function Se(e){switch(ie(e)){case 3:return!0;case 4:return!0;default:return!1}}function N(e,r){return e===r||e!==e&&r!==r}function ue(e,r){var i=e[r];if(i!=null){if(!z(i))throw new TypeError;return i}}function ce(e){var r=ue(e,S);if(!z(r))throw new TypeError;var i=r.call(e);if(!b(i))throw new TypeError;return i}function fe(e){return e.value}function le(e){var r=e.next();return r.done?!1:r}function he(e){var r=e.return;r&&r.call(e)}function U(e){var r=Object.getPrototypeOf(e);if(typeof e!="function"||e===A||r!==A)return r;var i=e.prototype,a=i&&Object.getPrototypeOf(i);if(a==null||a===Object.prototype)return r;var h=a.constructor;return typeof h!="function"||h===e?r:h}function Me(){var e;!d(P)&&typeof s.Reflect<"u"&&!(P in s.Reflect)&&typeof s.Reflect.defineMetadata=="function"&&(e=Te(s.Reflect));var r,i,a,h=new K,k={registerProvider:m,getProvider:u,setProvider:f};return k;function m(l){if(!Object.isExtensible(k))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case e===l:break;case d(r):r=l;break;case r===l:break;case d(i):i=l;break;case i===l:break;default:a===void 0&&(a=new W),a.add(l);break}}function p(l,y){if(!d(r)){if(r.isProviderFor(l,y))return r;if(!d(i)){if(i.isProviderFor(l,y))return r;if(!d(a))for(var _=ce(a);;){var v=le(_);if(!v)return;var O=fe(v);if(O.isProviderFor(l,y))return he(_),O}}}if(!d(e)&&e.isProviderFor(l,y))return e}function u(l,y){var _=h.get(l),v;return d(_)||(v=_.get(y)),d(v)&&(v=p(l,y),d(v)||(d(_)&&(_=new x,h.set(l,_)),_.set(y,v))),v}function c(l){if(d(l))throw new TypeError;return r===l||i===l||!d(a)&&a.has(l)}function f(l,y,_){if(!c(_))throw new Error("Metadata provider not registered.");var v=u(l,y);if(v!==_){if(!d(v))return!1;var O=h.get(l);d(O)&&(O=new x,h.set(l,O)),O.set(y,_)}return!0}}function Ee(){var e;return!d(P)&&b(s.Reflect)&&Object.isExtensible(s.Reflect)&&(e=s.Reflect[P]),d(e)&&(e=Me()),!d(P)&&b(s.Reflect)&&Object.isExtensible(s.Reflect)&&Object.defineProperty(s.Reflect,P,{enumerable:!1,configurable:!1,writable:!1,value:e}),e}function je(e){var r=new K,i={isProviderFor:function(c,f){var l=r.get(c);return d(l)?!1:l.has(f)},OrdinaryDefineOwnMetadata:m,OrdinaryHasOwnMetadata:h,OrdinaryGetOwnMetadata:k,OrdinaryOwnMetadataKeys:p,OrdinaryDeleteMetadata:u};return V.registerProvider(i),i;function a(c,f,l){var y=r.get(c),_=!1;if(d(y)){if(!l)return;y=new x,r.set(c,y),_=!0}var v=y.get(f);if(d(v)){if(!l)return;if(v=new x,y.set(f,v),!e.setProvider(c,f,i))throw y.delete(f),_&&r.delete(c),new Error("Wrong provider for target.")}return v}function h(c,f,l){var y=a(f,l,!1);return d(y)?!1:oe(y.has(c))}function k(c,f,l){var y=a(f,l,!1);if(!d(y))return y.get(c)}function m(c,f,l,y){var _=a(l,y,!0);_.set(c,f)}function p(c,f){var l=[],y=a(c,f,!1);if(d(y))return l;for(var _=y.keys(),v=ce(_),O=0;;){var de=le(v);if(!de)return l.length=O,l;var Ae=fe(de);try{l[O]=Ae}catch(xe){try{he(v)}finally{throw xe}}O++}}function u(c,f,l){var y=a(f,l,!1);if(d(y)||!y.delete(c))return!1;if(y.size===0){var _=r.get(f);d(_)||(_.delete(l),_.size===0&&r.delete(_))}return!0}}function Te(e){var r=e.defineMetadata,i=e.hasOwnMetadata,a=e.getOwnMetadata,h=e.getOwnMetadataKeys,k=e.deleteMetadata,m=new K,p={isProviderFor:function(u,c){var f=m.get(u);return!d(f)&&f.has(c)?!0:h(u,c).length?(d(f)&&(f=new W,m.set(u,f)),f.add(c),!0):!1},OrdinaryDefineOwnMetadata:r,OrdinaryHasOwnMetadata:i,OrdinaryGetOwnMetadata:a,OrdinaryOwnMetadataKeys:h,OrdinaryDeleteMetadata:k};return p}function D(e,r,i){var a=V.getProvider(e,r);if(!d(a))return a;if(i){if(V.setProvider(e,r,J))return J;throw new Error("Illegal state.")}}function Ie(){var e={},r=[],i=function(){function p(u,c,f){this._index=0,this._keys=u,this._values=c,this._selector=f}return p.prototype["@@iterator"]=function(){return this},p.prototype[S]=function(){return this},p.prototype.next=function(){var u=this._index;if(u>=0&&u<this._keys.length){var c=this._selector(this._keys[u],this._values[u]);return u+1>=this._keys.length?(this._index=-1,this._keys=r,this._values=r):this._index++,{value:c,done:!1}}return{value:void 0,done:!0}},p.prototype.throw=function(u){throw this._index>=0&&(this._index=-1,this._keys=r,this._values=r),u},p.prototype.return=function(u){return this._index>=0&&(this._index=-1,this._keys=r,this._values=r),{value:u,done:!0}},p}(),a=function(){function p(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(p.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),p.prototype.has=function(u){return this._find(u,!1)>=0},p.prototype.get=function(u){var c=this._find(u,!1);return c>=0?this._values[c]:void 0},p.prototype.set=function(u,c){var f=this._find(u,!0);return this._values[f]=c,this},p.prototype.delete=function(u){var c=this._find(u,!1);if(c>=0){for(var f=this._keys.length,l=c+1;l<f;l++)this._keys[l-1]=this._keys[l],this._values[l-1]=this._values[l];return this._keys.length--,this._values.length--,N(u,this._cacheKey)&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},p.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},p.prototype.keys=function(){return new i(this._keys,this._values,h)},p.prototype.values=function(){return new i(this._keys,this._values,k)},p.prototype.entries=function(){return new i(this._keys,this._values,m)},p.prototype["@@iterator"]=function(){return this.entries()},p.prototype[S]=function(){return this.entries()},p.prototype._find=function(u,c){if(!N(this._cacheKey,u)){this._cacheIndex=-1;for(var f=0;f<this._keys.length;f++)if(N(this._keys[f],u)){this._cacheIndex=f;break}}return this._cacheIndex<0&&c&&(this._cacheIndex=this._keys.length,this._keys.push(u),this._values.push(void 0)),this._cacheIndex},p}();return a;function h(p,u){return p}function k(p,u){return u}function m(p,u){return[p,u]}}function Pe(){var e=function(){function r(){this._map=new x}return Object.defineProperty(r.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),r.prototype.has=function(i){return this._map.has(i)},r.prototype.add=function(i){return this._map.set(i,i),this},r.prototype.delete=function(i){return this._map.delete(i)},r.prototype.clear=function(){this._map.clear()},r.prototype.keys=function(){return this._map.keys()},r.prototype.values=function(){return this._map.keys()},r.prototype.entries=function(){return this._map.entries()},r.prototype["@@iterator"]=function(){return this.keys()},r.prototype[S]=function(){return this.keys()},r}();return e}function Re(){var e=16,r=E.create(),i=a();return function(){function u(){this._key=a()}return u.prototype.has=function(c){var f=h(c,!1);return f!==void 0?E.has(f,this._key):!1},u.prototype.get=function(c){var f=h(c,!1);return f!==void 0?E.get(f,this._key):void 0},u.prototype.set=function(c,f){var l=h(c,!0);return l[this._key]=f,this},u.prototype.delete=function(c){var f=h(c,!1);return f!==void 0?delete f[this._key]:!1},u.prototype.clear=function(){this._key=a()},u}();function a(){var u;do u="@@WeakMap@@"+p();while(E.has(r,u));return r[u]=!0,u}function h(u,c){if(!w.call(u,i)){if(!c)return;Object.defineProperty(u,i,{value:E.create()})}return u[i]}function k(u,c){for(var f=0;f<c;++f)u[f]=Math.random()*255|0;return u}function m(u){if(typeof Uint8Array=="function"){var c=new Uint8Array(u);return typeof crypto<"u"?crypto.getRandomValues(c):typeof msCrypto<"u"?msCrypto.getRandomValues(c):k(c,u),c}return k(new Array(u),u)}function p(){var u=m(e);u[6]=u[6]&79|64,u[8]=u[8]&191|128;for(var c="",f=0;f<e;++f){var l=u[f];(f===4||f===6||f===8)&&(c+="-"),l<16&&(c+="0"),c+=l.toString(16).toLowerCase()}return c}}function q(e){return e.__=void 0,delete e.__,e}})}(n||(n={})),ar}ro();var no=Object.defineProperty,io=(n,t,o)=>t in n?no(n,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[t]=o,Ze=(n,t,o)=>io(n,typeof t!="symbol"?t+"":t,o);class oo{constructor(t,o){Ze(this,"_target"),Ze(this,"_key"),Ze(this,"_oldValue"),Ze(this,"_wasDefined",!1),Ze(this,"_isSwapped",!1),this._target=t,this._key=o,this._oldValue=this._target[this._key]}get isSwapped(){return this._isSwapped}get originalValue(){return this._oldValue}get value(){return this._target[this._key]}get target(){return this._target}restore(){this.isSwapped&&(this._wasDefined?this._target[this._key]=this._oldValue:delete this._target[this._key],this._isSwapped=!1)}swap(t){this.isSwapped||(this._wasDefined=Object.hasOwn(this._target,this._key),this._oldValue=this._target[this._key]),this._target[this._key]=t,this._isSwapped=!0}}const ao={onlyIfNotExists:!0,isFactory:!1};class so{constructor(t,o,s={}){if(ut(this,"_installedInstances",new Map),ut(this,"_path"),ut(this,"_targetValue"),ut(this,"_options"),this._path=t.split("."),this._path.length===0)throw new Error("Path must not be empty");this._targetValue=o,this._options={...ao,...s}}_getTargetObject(t){let o=t;for(const s of this._path.slice(0,this._path.length-1))o[s]||(o[s]={}),o=o[s];return o}_createSwapper(t){const o=this._getTargetObject(t);return new oo(o,this._path.at(-1))}install({sdk:t,...o}){if(this._installedInstances.has(t))return;const s=this._createSwapper(t);if(!(s.value&&this._options.onlyIfNotExists)){if(this._options.isFactory&&typeof this._targetValue=="function"){const w=this._targetValue({sdk:t,...o});s.swap(w)}else s.swap(this._targetValue);this._installedInstances.set(t,s)}}uninstall({sdk:t}){const o=this._installedInstances.get(t);o&&(o.restore(),this._installedInstances.delete(t))}}class kt extends Error{constructor(t){super(t),this.name="MiddlewareError"}}class uo extends kt{constructor(t){super(t),this.name="MiddlewareFlowError"}}class co extends kt{constructor(t="Action prevented by middleware."){super(t),this.name="MiddlewarePreventedError"}}function ct(n){if(n===null||typeof n!="object")return n;if(Array.isArray(n))return n.map(o=>ct(o));if(n instanceof Date)return new Date(n);const t={};for(const o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=ct(n[o]));return t}function ur(n){Object.freeze(n);for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)){const o=n[t];o&&typeof o=="object"&&ur(o)}return n}function fo(n){let t=!1,o=null;const s=()=>t,w=()=>t=!0;return[function(...g){return w(),o=n.apply(this,g)},s,()=>{if(!t)throw new Error("Function has not been called yet");return o}]}class lo{constructor(t,o,s,w){B(this,"actionPoint"),B(this,"data"),B(this,"originalData"),B(this,"wmeSdk"),this.data=o,Object.defineProperty(this,"actionPoint",{value:t,writable:!1,configurable:!1,enumerable:!0}),Object.defineProperty(this,"originalData",{value:s,writable:!1,configurable:!1,enumerable:!0}),Object.defineProperty(this,"wmeSdk",{value:w,writable:!1,configurable:!1,enumerable:!0})}}class ho{constructor(t,o,s,w){B(this,"actionPoint"),B(this,"data"),B(this,"mutatedData"),B(this,"wmeSdk"),B(this,"handlers"),this.actionPoint=t,this.data=this.mutatedData=o,this.wmeSdk=s,this.handlers=w}getSafeImmutableData(){return ur(ct(this.data))}getSafeMutableData(){return ct(this.mutatedData)}createContext(){return new lo(this.actionPoint,this.getSafeMutableData(),this.getSafeImmutableData(),this.wmeSdk)}async run(t){let o=-1;const s=async w=>{if(w<=o)throw await new Promise(I=>setTimeout(I,1e3)),new uo("next() called multiple times within the same middleware or improperly nested.");if(o=w,w>=this.handlers.length)return t(this.mutatedData);const g=this.handlers[o],T=this.createContext(),[S,j,$]=fo(()=>(this.mutatedData=T.data,s(w+1)));try{return await Promise.resolve(g(T,S)),j()?await $():(console.warn(`Middleware handler "${g.name||"anonymous"}" did not call next() and did not throw an error. This is not recommended and may cause unexpected behavior.
Ensure to always call next() or throw an error to stop the middleware chain.`),await S())}catch(I){if(I instanceof co)return null;throw I}};return await s(0)}}class po extends EventTarget{constructor(t){super(),B(this,"middleware",new Map),B(this,"wmeSdk"),this.wmeSdk=t}register(t,o){if(typeof o!="function")throw new kt("Middleware handler must be a function.");const s=this.middleware.get(t)||[],w={handler:o};s.push(w),this.middleware.set(t,s),this.dispatchEvent(new CustomEvent("middlewareRegistered",{detail:{actionPoint:t}}));let g=!1;return()=>{if(g)return;const T=this.middleware.get(t);if(!T)return;const S=T.indexOf(w);S!==-1&&(T.splice(S,1),T.length===0&&this.middleware.delete(t),g=!0,this.dispatchEvent(new CustomEvent("middlewareUnregistered",{detail:{actionPoint:t}})))}}async execute(t,o,s){const w=this.middleware.get(t)||[];await new ho(t,o,this.wmeSdk,w.map(g=>g.handler)).run(s)}hasListeners(t){return this.middleware.has(t)&&(this.middleware.get(t)||[]).length>0}}const Ot=Symbol("REGISTRY");var yo=Object.defineProperty,wo=(n,t,o)=>t in n?yo(n,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[t]=o,Ce=(n,t,o)=>wo(n,typeof t!="symbol"?t+"":t,o);class _o{constructor(t,o){Ce(this,"_target"),Ce(this,"_key"),Ce(this,"_oldValue"),Ce(this,"_wasDefined",!1),Ce(this,"_isSwapped",!1),this._target=t,this._key=o,this._oldValue=this._target[this._key]}get isSwapped(){return this._isSwapped}get originalValue(){return this._oldValue}get value(){return this._target[this._key]}get target(){return this._target}restore(){this.isSwapped&&(this._wasDefined?this._target[this._key]=this._oldValue:delete this._target[this._key],this._isSwapped=!1)}swap(t){this.isSwapped||(this._wasDefined=Object.hasOwn(this._target,this._key),this._oldValue=this._target[this._key]),this._target[this._key]=t,this._isSwapped=!0}}let cr=class{constructor(n,t,o){Ce(this,"_enabled",!1),Ce(this,"_fnSwapper"),Ce(this,"_interceptionFunction"),Ce(this,"_middlewares",[]),this._fnSwapper=new _o(n,t),this._interceptionFunction=o}get enabled(){return this._fnSwapper.isSwapped&&this._enabled}disable(){this._enabled=!1,this.enabled}restore(){this._fnSwapper.restore()}enable(){this._enabled=!0,this._fnSwapper.isSwapped||this.swapToInterceptor()}swapToInterceptor(){const n=this;this._fnSwapper.swap(function(...t){if(!n._enabled)return n.callOriginalInvocator(...t);const o=n.runMiddlewares(t);if(o){if("output"in o)return o.output;"input"in o&&(t=o.input)}return n._interceptionFunction.call(this,n.getOriginalInvocator(this),...t)})}getOriginalInvocator(n){return this._fnSwapper.originalValue.bind(n??this._fnSwapper.target)}callOriginalInvocator(...n){return this.getOriginalInvocator()(...n)}runMiddlewares(n){for(const t of this._middlewares){const o=t(...n);if(o){if("output"in o)return o;"input"in o&&(n=o.input)}}return{input:n}}registerMiddleware(n){this._middlewares.push(n)}};function Ye(){return"unsafeWindow"in window?window.unsafeWindow:window}class fr{constructor(t){B(this,"isMiddlewareDefined",!1),B(this,"uninstaller",null),B(this,"registry"),B(this,"artifacts"),B(this,"handleMiddlewareRegistered",o=>{o.detail.actionPoint===this.options.actionPoint&&this.defineMiddleware(this.artifacts)}),B(this,"handleMiddlewareUnregistered",o=>{var s;o.detail.actionPoint===this.options.actionPoint&&((s=this.registry)!=null&&s.hasListeners(this.options.actionPoint)||this.undefineMiddleware())}),this.options=t}addRegistryEvents(){var t,o;(t=this.registry)==null||t.addEventListener("middlewareRegistered",this.handleMiddlewareRegistered),(o=this.registry)==null||o.addEventListener("middlewareUnregistered",this.handleMiddlewareUnregistered)}removeRegistryEvents(){var t,o;(t=this.registry)==null||t.removeEventListener("middlewareRegistered",this.handleMiddlewareRegistered),(o=this.registry)==null||o.removeEventListener("middlewareUnregistered",this.handleMiddlewareUnregistered)}defineMiddleware(t){this.isMiddlewareDefined||(this.uninstaller=this.options.install(o=>new Promise(s=>{if(!this.registry)return s(o);this.registry.execute(this.options.actionPoint,o,s)}),t)||null,this.isMiddlewareDefined=!0)}undefineMiddleware(){var t;this.isMiddlewareDefined&&((t=this.uninstaller)==null||t.call(this),this.isMiddlewareDefined=!1)}install({artifacts:t}){var o;this.artifacts=t,this.registry=t[this.options.registryArtifactName??Ot],(o=this.registry)!=null&&o.hasListeners(this.options.actionPoint)&&this.defineMiddleware(t),this.addRegistryEvents()}uninstall(){this.removeRegistryEvents(),this.undefineMiddleware(),this.registry=void 0}}function go(){return new Promise(n=>{const t="problems:shown",o=Ye(),s=async w=>{if(w.type!=="mapUpdateRequest")return;o.W.app.off(t,s);const g=await o.W.problemsController.editController.adapter.getCommentable();n(g.constructor)};o.W.app.on(t,s)})}const vo=new fr({actionPoint:"updateRequests.addComment",install:n=>{let t=null;return go().then(o=>{t=new cr(o.prototype,"addComment",async function(s,w,...g){const T=await n({updateRequestId:this.conversation.getID(),message:w});return s(T.message,...g)}),t.enable()}),()=>{t==null||t.disable()}}});function bo(n){return"subActions"in n&&Array.isArray(n.subActions)}const mo=["bigJunctions","cities","countries","editSuggestions","junctions","majorTrafficEvents","managedAreas","mapComments","mapProblems","mapUpdateRequests","nodes","onlineEditors","permanentHazards","problemDetails","restrictedDrivingAreas","restrictedEditingAreas","roadClosures","schedules","segments","segmentHouseNumbers","segmentSuggestions","signTypes","states","streets","turnClosures","updateRequestSessions","users","userAreas","venues"];function St(n,t){if(typeof n!="object"||n===null)return t;if(Array.isArray(n)&&Array.isArray(t))return[...n,...t];const o={...n};for(const s in t)t[s]!==void 0&&(s in o&&typeof o[s]=="object"?o[s]=St(o[s],t[s]):o[s]=t[s]);return o}function ko(n,t){if(!n||!t){const w=n||t;if(!w)throw new Error("Both responses are null or undefined");return w}const o=Mt(n),s=Mt(t);if(o&&s)return{pendingEdits:n.pendingEdits||t.pendingEdits,saveCount:{bigJunctions:n.saveCount.bigJunctions+t.saveCount.bigJunctions,nodes:n.saveCount.nodes+t.saveCount.nodes,segments:n.saveCount.segments+t.saveCount.segments,venues:n.saveCount.venues+t.saveCount.venues},unsavedFeatures:[...n.unsavedFeatures,...t.unsavedFeatures]};if(!o&&!s)return{...[...mo,"connections"].reduce((w,g)=>{const T=n[g],S=t[g];return T&&S?w[g]=St(T,S):T?w[g]=T:S&&(w[g]=S),w},{}),status:n.status,synced:n.synced,unsavedFeatures:St(n.unsavedFeatures,t.unsavedFeatures)};throw new Oo(n,t)}function Mt(n){return"saveCount"in n}class Oo extends Error{constructor(t,o){super("Responses have different versions"),this.a=t,this.b=o}get preferredResponse(){return Mt(this.a)?this.b:this.a}}function lr(n,t){const o=[];if(typeof t!="function"){const s=t;t=w=>s===w}for(const s in n){const w=n[s];if(t(w))return o.concat(parseInt(s));if(w.subActions){const g=lr(w.subActions,t);if(g)return o.concat(parseInt(s),...g)}}return null}class ft{constructor(t){B(this,"actions"),this.actions=t}getActionsFlat(){return this.actions.flatMap(t=>bo(t)?t.getSubActions():[t])}getActionPath(t){return lr(this.actions,t)}hasAction(t){return this.getActionPath(t)!==null}removeAction(t){var o;const s=t.pop();let w={subActions:this.actions};for(;t.length;)w=(o=w.subActions)==null?void 0:o[t.shift()];s!==void 0&&w.subActions.splice(s,1)}replaceAction(t,...o){var s;const w=t.pop();let g={subActions:this.actions};for(;t.length;)g=(s=g.subActions)==null?void 0:s[t.shift()];w!==void 0&&g.subActions.splice(w,1,...o)}addAction(t){this.actions.push(t)}}class So{constructor(t,o){B(this,"saveInterceptor"),this.saveInterceptor=new cr(t.controller,"save",async function(s,w,...g){const T=new ft((w==null?void 0:w.actions)||this.model.actionManager.getActions()),S=await Promise.resolve(o(T));if(S){let j=null;for(const $ of S){const I=await s({...w||{},actions:$.actions},...g);j?j=ko(j,I):j=I}return j}return s({...w||{},actions:T.actions},...g)})}enable(){return this.saveInterceptor.enable()}disable(){return this.saveInterceptor.disable()}}const Mo="ADD_ROAD_CLOSURE";function Et(n){return(n==null?void 0:n.actionName)===Mo&&(n==null?void 0:n.closure)!==void 0&&(n==null?void 0:n.segment)!==void 0}const Eo="ADD_TURN_CLOSURE";function jt(n){var t;return n.actionName===Eo&&((t=n.getObject())==null?void 0:t.type)==="turnClosure"}function hr(n){return n.actionName==="UPDATE_OBJECT"}function dr(n){var t;return hr(n)&&((t=n.object)==null?void 0:t.type)==="roadClosure"}function pr(n){var t;return hr(n)&&((t=n.object)==null?void 0:t.type)==="turnClosure"}const jo="DELETE_ROAD_CLOSURE";function Tt(n){return(n==null?void 0:n.actionName)===jo&&(n==null?void 0:n.closure)!==void 0&&(n==null?void 0:n.segment)!==void 0}function To(n){return n.actionName==="DELETE_OBJECT"}function It(n){return To(n)&&n.object.type==="turnClosure"}function Io(n){return n.filter(t=>Et(t)||jt(t)||dr(t)||pr(t)||Tt(t)||It(t))}const Po={roadClosure:"SEGMENT",turnClosure:"TURN"};function Qe(n){const t={id:n.state==="INSERT"?null:n.attributes.id,closureType:Po[n.type],startDate:new Date(n.attributes.startDate),endDate:new Date(n.attributes.endDate),description:n.attributes.reason,eventId:n.attributes.eventId};switch(n.type){case"roadClosure":return{...t,closureType:"SEGMENT",permanent:n.getAttribute("permanent"),segmentId:n.getAttribute("segID"),forward:n.getAttribute("forward"),nodeClosure:n.getAttribute("fromNodeClosed"),provider:n.getAttribute("provider")};case"turnClosure":return{...t,closureType:"TURN",permanent:!0,fromSegmentId:n.getAttribute("fromSegID"),fromSegmentForward:n.getAttribute("fromSegForward"),toSegmentId:n.getAttribute("toSegID"),toSegmentForward:n.getAttribute("toSegForward"),nodeId:n.getAttribute("nodeConnID")}}}function yr(n,t){return typeof n!=typeof t||typeof n!="object"||!n||!t?!1:Object.keys(n).every(o=>{if(!Object.prototype.hasOwnProperty.call(t,o))return!1;const s=n[o],w=t[o];return yr(s,w)})}function Ro(n,t){return t.some(o=>yr(o,n))}function wr(n,t){return n.length!==t.length?!1:n.every(o=>Ro(o,t))}var Ao=Object.defineProperty,xo=(n,t,o)=>t in n?Ao(n,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[t]=o,Xe=(n,t,o)=>xo(n,typeof t!="symbol"?t+"":t,o);let $o=class{constructor(n,t){Xe(this,"_target"),Xe(this,"_key"),Xe(this,"_oldValue"),Xe(this,"_wasDefined",!1),Xe(this,"_isSwapped",!1),this._target=n,this._key=t,this._oldValue=this._target[this._key]}get isSwapped(){return this._isSwapped}get originalValue(){return this._oldValue}get value(){return this._target[this._key]}get target(){return this._target}restore(){this.isSwapped&&(this._wasDefined?this._target[this._key]=this._oldValue:delete this._target[this._key],this._isSwapped=!1)}swap(n){this.isSwapped||(this._wasDefined=Object.hasOwn(this._target,this._key),this._oldValue=this._target[this._key]),this._target[this._key]=n,this._isSwapped=!0}};function Pt(){return"unsafeWindow"in window?window.unsafeWindow:window}var Do=Object.defineProperty,Fo=(n,t,o)=>t in n?Do(n,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[t]=o,_r=(n,t,o)=>Fo(n,typeof t!="symbol"?t+"":t,o);function et(){return"unsafeWindow"in window?window.unsafeWindow:window}var Vo=Object.defineProperty,Co=(n,t,o)=>t in n?Vo(n,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[t]=o,ze=(n,t,o)=>Co(n,typeof t!="symbol"?t+"":t,o);class zo{constructor(t,o){ze(this,"_target"),ze(this,"_key"),ze(this,"_oldValue"),ze(this,"_wasDefined",!1),ze(this,"_isSwapped",!1),this._target=t,this._key=o,this._oldValue=this._target[this._key]}get isSwapped(){return this._isSwapped}get originalValue(){return this._oldValue}get value(){return this._target[this._key]}get target(){return this._target}restore(){this.isSwapped&&(this._wasDefined?this._target[this._key]=this._oldValue:delete this._target[this._key],this._isSwapped=!1)}swap(t){this.isSwapped||(this._wasDefined=Object.hasOwn(this._target,this._key),this._oldValue=this._target[this._key]),this._target[this._key]=t,this._isSwapped=!0}}class Ko{constructor(t,o,s){ze(this,"_enabled",!1),ze(this,"_fnSwapper"),ze(this,"_interceptionFunction"),ze(this,"_middlewares",[]),this._fnSwapper=new zo(t,o),this._interceptionFunction=s}get enabled(){return this._fnSwapper.isSwapped&&this._enabled}disable(){this._enabled=!1,this.enabled}restore(){this._fnSwapper.restore()}enable(){this._enabled=!0,this._fnSwapper.isSwapped||this.swapToInterceptor()}swapToInterceptor(){const t=this;this._fnSwapper.swap(function(...o){if(!t._enabled)return t.callOriginalInvocator(...o);const s=t.runMiddlewares(o);if(s){if("output"in s)return s.output;"input"in s&&(o=s.input)}return t._interceptionFunction.call(this,t.getOriginalInvocator(this),...o)})}getOriginalInvocator(t){return this._fnSwapper.originalValue.bind(t??this._fnSwapper.target)}callOriginalInvocator(...t){return this.getOriginalInvocator()(...t)}runMiddlewares(t){for(const o of this._middlewares){const s=o(...t);if(s){if("output"in s)return s;"input"in s&&(t=s.input)}}return{input:t}}registerMiddleware(t){this._middlewares.push(t)}}class Wo{constructor(t){_r(this,"_fetchInterceptor"),_r(this,"_interceptionFilters",new Set),this._fetchInterceptor=new Ko(t,"fetch",(o,s,w)=>{for(const g of this._interceptionFilters)if(g.shouldIntercept(s,w))return this.shouldKeepFilter(g,s,w)||this.removeInterceptionFilter(g),g.intercept(s,w);return o(s,w)})}enable(){this._fetchInterceptor.enable()}disable(){this._fetchInterceptor.disable()}addInterceptionFilter(t){this.enable(),this._interceptionFilters.add(t)}removeInterceptionFilter(t){this._interceptionFilters.delete(t)}shouldKeepFilter(t,o,s){return typeof t.shouldKeep=="function"?t.shouldKeep(o,s):typeof t.shouldKeep=="boolean"?t.shouldKeep:!1}}function Ho(n){return n=n instanceof URL?n:new URL(n,et().location.href),t=>typeof t=="string"?new URL(t,et().location.href).pathname===n.pathname:t instanceof URL?t.pathname===n.pathname:new URL(t.url,et().location.href).pathname===new URL(n,et().location.href).pathname}function No(n,t,o){const s=new Response(t,o),w=new URL(n,location.toString());return Object.defineProperty(s,"url",{value:w}),s}function Uo(n,t){const o=JSON.stringify(t),s=new Headers({"Content-Type":"application/json"});return No(n,o,{headers:s})}const qo=new Wo(et());function Lo(n){return!("descartesHttpClient"in n)&&"createAbortController"in n&&typeof n.createAbortController=="function"}function Go(){const n=Pt().W.controller.descartesClient,t=Lo(n)?n:n.descartesHttpClient,o=new $o(t,"createAbortController");o.swap(()=>(o.restore(),new AbortController))}function Bo(n){const t=Pt();return Go(),t.W.controller.descartesClient.getFeatures([0,0,0,0],{[n]:!0},{})}async function gr(n,t){const o=Pt().W.Config.paths.features;qo.addInterceptionFilter({shouldIntercept:Ho(o),intercept(){return Promise.resolve(Uo(o,{[n]:{objects:[t]}}))}});const{[n]:s}=await Bo(n),[w]=s.objects;return w.constructor}const vr=Symbol("TurnClosure"),br=Symbol("RoadClosure");function mr(n){const t=n.getFullYear().toString().padStart(4,"0"),o=(n.getMonth()+1).toString().padStart(2,"0"),s=n.getDate().toString().padStart(2,"0"),w=n.getHours().toString().padStart(2,"0"),g=n.getMinutes().toString().padStart(2,"0");return`${t}-${o}-${s} ${w}:${g}`}function Jo(n){const t=Ye(),o={SEGMENT:"roadClosure",TURN:"turnClosure"};return t.W.model.getRepository(o[n])}function Zo(n,t){const o={id:n.id||Jo(n.closureType).idGenerator.next(),attributions:null,reason:n.description,startDate:mr(n.startDate),endDate:mr(n.endDate),eventId:n.eventId,externalProvider:null,externalProviderId:null,provider:null,createdBy:null,createdOn:null,updatedBy:null,updatedOn:null,permissions:-1,geometry:null};switch(n.closureType){case"SEGMENT":return new t[br]({...o,closureType:"SEGMENT",permanent:n.permanent,segID:n.segmentId,forward:n.forward,fromNodeClosed:n.nodeClosure});case"TURN":return new t[vr]({...o,closureType:"TURN",permanent:!0,fromSegID:n.fromSegmentId,fromSegForward:n.fromSegmentForward,toSegID:n.toSegmentId,toSegForward:n.toSegmentForward,nodeConnID:n.nodeId})}}function kr(n){return Et(n)?{...Qe(n.closure),id:null}:jt(n)?{...Qe(n.getObject()),id:null}:dr(n)?Qe(n.getObject()):Tt(n)?Qe(n.closure):pr(n)||It(n)?Qe(n.getObject()):null}const Yo=[{async install(){const n=await gr("roadClosures",{});return{[br]:n}}},{async install(){const n=await gr("turnClosures",{});return{[vr]:n}}},new fr({actionPoint:"closures.save",install:(n,t)=>{const o=Ye(),s=new So(o.W,async w=>{var g,T;const S=w.getActionsFlat(),j=Io(S);if(!j.length)return;const{delete:$,set:I}=j.reduce((F,C)=>((Tt(C)||It(C)?F.delete:F.set).push(C),F),{delete:[],set:[]}),E={source:void 0,closures:I.map(kr).filter(Boolean),deleteClosures:$.map(kr).filter(Boolean)},A=await n(E),x=wr(E.closures,A.closures),W=wr(E.deleteClosures,A.deleteClosures);if(!x&&!W)return;const K=(g=j.find(F=>Et(F)))==null?void 0:g.constructor,P=(T=j.find(F=>jt(F)))==null?void 0:T.constructor;j.forEach(F=>{const C=w.getActionPath(F);C&&(w.removeAction(C),F.undoAction(o.W.model))});const{addClosureActions:V,updateClosureActions:J}=A.closures.reduce((F,C)=>{const L=Ye(),G=Zo(C,t);if(!G)return F;if(!C.id){const Z=(()=>{switch(C.closureType){case"SEGMENT":{if(!K){const pe=L.require("Waze/Action/CreateObject");return new pe(G)}const Y=L.W.model.segments.getObjectById(C.segmentId);return new K(G,Y)}case"TURN":{if(!P){const _e=L.require("Waze/Action/CreateObject");return new _e(G)}const Y=L.W.model.segments.getObjectById(C.fromSegmentId),pe=L.W.model.segments.getObjectById(C.toSegmentId);return new P(G,Y,pe)}default:throw new Error("Unregistered closure factory for closure type "+C.closureType)}})();Z&&F.addClosureActions.push(Z)}const ye=(()=>{const Z=L.W.model.getRepository(C.closureType==="SEGMENT"?"roadClosure":"turnClosure").getObjectById(C.id);if(!Z)return null;const Y=L.require("Waze/Action/UpdateObject");return new Y(Z,G.attributes)})();return ye&&F.updateClosureActions.push(ye),F},{addClosureActions:[],updateClosureActions:[]}),we=A.deleteClosures.map(F=>{const C=Ye(),L=C.W.model.getRepository(F.closureType==="SEGMENT"?"roadClosure":"turnClosure").getObjectById(F.id);if(!L)return null;const G=C.require("Waze/Action/DeleteObject");return new G(L)});return[new ft(J.filter(Boolean)),new ft(we.filter(Boolean)),new ft(V.filter(Boolean))].filter(F=>F.actions.length>0)});return s.enable(),()=>{s.disable()}}})],Qo=[{install:({sdk:n})=>({[Ot]:new po(n)})},new so("Events.registerMiddleware",({artifacts:n})=>(t,o)=>{const s=n[Ot];if(!s)throw new Error("Middleware registry not found in artifacts");return s==null?void 0:s.register(t,o)},{isFactory:!0}),vo,...Yo],Xo={"Editing.Transactions":{hook:Br},"DataModel.MapComments":{hook:Pn},"DataModel.PermanentHazards":{hook:di},"DataModel.BigJunctions":{hook:Yi},Middlewares:{hook:Qo}};function Rt(n){const[t,o,s]=n.split(".").map(Number);return{major:t,minor:o,patch:s}}function At(n,t){return n?t?n.major&&t.major&&n.major!==t.major?n.major-t.major:n.minor&&t.minor&&n.minor!==t.minor?n.minor-t.minor:n.patch&&t.patch&&n.patch!==t.patch?n.patch-t.patch:0:1:-1}function ea(n,t,o="highest"){let s=null;typeof n.highest=="string"&&(n.highest=Rt(n.highest)),typeof n.lowest=="string"&&(n.lowest=Rt(n.lowest));for(const w of t){if(!w.version)continue;if(!s){s=w;continue}if(n.highest&&At(w.version,n.highest)>0||n.lowest&&At(w.version,n.lowest)<0)continue;const g=w.version,T=s.version,S=At(g,T);(o==="highest"&&S>0||o==="lowest"&&S<0)&&(s=w)}if(!s)throw new Error("No matching version found");return s}const ta={"0.1":n=>{const t=n.constructor;return new t(n.getScriptId(),n.getScriptName())}};function ra(n){const t=Object.entries(ta).map(([s,w])=>({version:Rt(s),cloner:w})),{cloner:o}=ea({highest:n.getSDKVersion()},t);return o(n)}const Or=new jr(Xo);async function na(n,t={}){if(t.immutable&&(n=ra(n)),n.State.isInitialized()||await n.Events.once({eventName:"wme-initialized"}),t.hooks)for(const o of t.hooks)await Or.installHook(o,n);else await Or.installAllHooks(n);return n}return na}();
